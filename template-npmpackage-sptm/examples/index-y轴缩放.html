<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>折线图示例</title>
    <style>
        canvas {
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <canvas id="myCanvas" width="800" height="400"></canvas>
    <button id="zoomIn">放大</button>
    <button id="zoomOut">缩小</button>

    <script>
class LineChart {
    constructor(canvasId) {
        this.canvas = document.getElementById(canvasId);
        this.ctx = this.canvas.getContext('2d');
        this.data = [];
        this.labels = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
        this.maxY = 100; // 初始最大值
        this.minY = 0;   // 初始最小值
        this.scaleFactor = 10; // 每次滚动改变的步进大小
        this.canvasWidth = this.canvas.width;
        this.canvasHeight = this.canvas.height;

        // 绑定鼠标滚轮事件
        this.canvas.addEventListener('wheel', (event) => this.handleWheel(event));
    }

    setData(data) {
        if (data.length !== 7) {
            throw new Error('Data array must have 7 values for each day of the week.');
        }
        this.data = data;
        this.draw();
    }

    handleWheel(event) {
        event.preventDefault(); // 防止页面滚动
        
        const mouseY = event.offsetY; // 获取鼠标 Y 轴位置
        const relativeY = this.canvasHeight - 50 - mouseY; // 相对画布底部的 Y 值
        const currentYValue = (relativeY / (this.canvasHeight - 80)) * (this.maxY - this.minY) + this.minY;

        if (event.deltaY < 0) { // 向上滚动，增加范围
            this.maxY = Math.min(this.maxY + this.scaleFactor, 100);
            this.minY = Math.min(this.minY + this.scaleFactor, this.maxY);
        } else { // 向下滚动，减少范围
            this.maxY = Math.max(currentYValue + this.scaleFactor, this.minY);
            this.minY = Math.max(this.minY, Math.max(currentYValue - this.scaleFactor, 0));
        }

        this.draw();
    }

    draw() {
        this.clearCanvas();
        this.drawAxes();
        this.drawLine();
    }

    clearCanvas() {
        this.ctx.clearRect(0, 0, this.canvasWidth, this.canvasHeight);
    }

    drawAxes() {
        // Draw X axis
        this.ctx.beginPath();
        this.ctx.moveTo(50, this.canvasHeight - 50);
        this.ctx.lineTo(this.canvasWidth - 30, this.canvasHeight - 50);
        this.ctx.stroke();

        // Draw Y axis
        this.ctx.beginPath();
        this.ctx.moveTo(50, this.canvasHeight - 50);
        this.ctx.lineTo(50, 30);
        this.ctx.stroke();

        // Draw X labels
        this.labels.forEach((label, index) => {
            const x = 50 + (index * (this.canvasWidth - 80) / 6);
            this.ctx.fillText(label, x, this.canvasHeight - 30);
        });

        // Draw Y labels (5个标签)
        const labelCount = 5;
        for (let i = 0; i <= labelCount; i++) {
            const yValue = this.minY + (i * (this.maxY - this.minY) / labelCount); // 根据当前最小值和最大值计算 Y 值
            const y = this.canvasHeight - 50 - ((yValue - this.minY) / (this.maxY - this.minY)) * (this.canvasHeight - 80);
            this.ctx.fillText(Math.round(yValue), 10, y);
            this.ctx.beginPath();
            this.ctx.moveTo(50, y);
            this.ctx.lineTo(this.canvasWidth - 30, y);
            this.ctx.strokeStyle = '#e0e0e0';
            this.ctx.stroke();
        }
    }

    drawLine() {
        this.ctx.beginPath();
        this.data.forEach((value, index) => {
            const x = 50 + (index * (this.canvasWidth - 80) / 6);
            const y = this.canvasHeight - 50 - ((value - this.minY) / (this.maxY - this.minY)) * (this.canvasHeight - 80);
            if (index === 0) {
                this.ctx.moveTo(x, y);
            } else {
                this.ctx.lineTo(x, y);
            }
        });
        this.ctx.strokeStyle = 'blue';
        this.ctx.lineWidth = 2;
        this.ctx.stroke();
    }
}

// 使用示例
const chart = new LineChart('myCanvas');
chart.setData([10, 20, 30, 40, 50, 60, 70]); // 输入一周的数据

    </script>
</body>
</html>
