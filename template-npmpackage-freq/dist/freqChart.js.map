{"version":3,"file":"freqChart.js","sources":["../src/utils/index.js","../src/index.js"],"sourcesContent":["/**\r\n * 深度合并对象\r\n * @param {*} target 目标对象\r\n * @param {*} source 源对象\r\n * @returns \r\n */\r\nfunction deepMerge(target, source) {\r\n  for (var key in source) {\r\n    if (source.hasOwnProperty(key)) {\r\n      if (typeof source[key] === 'object' && source[key] !== null && !Array.isArray(source[key]) && !Array.isArray(target[key])) {\r\n        if (!target[key]) {\r\n          target[key] = {};\r\n        }\r\n        deepMerge(target[key], source[key]);\r\n      } else {\r\n        target[key] = source[key];\r\n      }\r\n    }\r\n  }\r\n  return target;\r\n}\r\n\r\n//拷贝\r\nfunction deepCopy(obj) {\r\n  // 如果传入的不是对象，则直接返回该值（基本类型数据会被直接返回）\r\n  if (typeof obj !== 'object' || obj === null) {\r\n      return obj;\r\n  }\r\n\r\n  // 根据传入对象的类型创建一个新的目标对象或数组\r\n  var newObj = Array.isArray(obj) ? [] : {};\r\n\r\n  // 遍历原始对象的属性或数组元素\r\n  for (var key in obj) {\r\n      // 只复制对象自身的属性，不复制原型链上的属性\r\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n          // 递归调用深拷贝函数，复制每个属性的值\r\n          newObj[key] = deepCopy(obj[key]);\r\n      }\r\n  }\r\n\r\n  return newObj;\r\n}\r\n/**\r\n * 获取设备像素比 (DPR)\r\n * @returns {number} 当前设备的设备像素比\r\n */\r\nfunction getDevicePixelRatio() {\r\n  return window.devicePixelRatio || 1; // 如果没有定义，则返回 1\r\n}\r\n\r\n/**\r\n * y轴刻度计算\r\n * @param {*} width 高度\r\n * @param {*} minValue 最小值\r\n * @param {*} maxValue 最大值\r\n * @param {*} fixedStep 固定步长\r\n * @param {*} zooms 层级\r\n * @param {*} stepStart 最小刻度范围\r\n * @param {*} stepEnd 最大刻度范围\r\n * @returns \r\n */\r\nfunction calculateStepValues(width,minValue, maxValue, fixedStep,zooms,stepStart, stepEnd,labelnum) {\r\n  var labels = [];\r\n  var gridLabels=[]\r\n  var zoom=zooms||1;\r\n  var stepValue = Math.round(fixedStep / zoom);\r\n  var pxStep = width / stepValue;\r\n  var labelStep =width\r\n  maxValue = minValue+stepValue*(labelnum-1);\r\n  if (stepValue <= 1) {\r\n    stepValue= 1;\r\n  }\r\n  var gridstepValue=stepValue/2\r\n  // 从第一个步进值开始，找到在 minValue 和 maxValue 范围内的所有步进值\r\n  for (var value = stepStart; value <= stepEnd; value += stepValue) {\r\n      if (value >= minValue && value <= maxValue) {\r\n        labels.push(value);\r\n      }\r\n  }\r\n  for (var value = stepStart; value <= stepEnd; value += gridstepValue) {\r\n    if (value >= minValue && value <= maxValue) {\r\n      gridLabels.push(value);\r\n    }\r\n  }\r\n  var minDiff=labels[0]-minValue\r\n  return {labelStep,pxStep,labels,stepValue,minDiff,gridLabels,maxValue,minValue};\r\n}\r\n\r\n/**\r\n * 计算x轴的宽度\r\n * @param {*} widths 总宽度 \r\n * @param {*} widths 数据宽度 \r\n * @param {*} minSpacing \r\n * @returns \r\n */\r\nfunction calculateWidths(clientWidth,widths, minSpacing) {\r\n  var totalWidth = clientWidth; // 总宽度\r\n  var numberOfSegments = widths.length; // 段数\r\n  var defaultMinWidth = 50; // 默认最小宽度\r\n  var maxSpacing = 30; // 最大间距\r\n\r\n  // 检查输入的 widths 数组长度是否为 5\r\n  if (widths.length !== numberOfSegments) {\r\n      throw new Error(\"Widths array must have exactly 5 elements.\"); // 抛出错误\r\n  }\r\n\r\n  // 计算当前需求\r\n  \r\n  var totalDemand = widths.reduce((a, b) => a + Math.max(b, defaultMinWidth), 0);\r\n  var totalSpacing = (numberOfSegments - 1) * minSpacing; // 计算总间距\r\n\r\n  // 如果当前需求加上间距大于总宽度，调整最小宽度\r\n  var minWidth = defaultMinWidth;\r\n  if (totalDemand + totalSpacing > totalWidth) {\r\n      var minWidthNum = widths.filter(w => w === 1).length;\r\n      if(totalDemand - totalSpacing-minWidthNum*1 <totalWidth){\r\n        minWidth = Math.floor((totalWidth - totalSpacing) / minWidthNum);\r\n      }\r\n      \r\n  }\r\n  var finalWidths = widths.map((w) => w === 1 ? minWidth : w);\r\n  // 调整 finalWidths 根据新的最小宽度\r\n  \r\n\r\n  // 计算已分配的宽度\r\n  var assignedWidth = finalWidths.reduce((a, b) => a + b, 0);\r\n  var assignedSpacing = (numberOfSegments - 1) * minSpacing;\r\n\r\n  // 如果总需求加上间距小于总宽度，进行宽度调整\r\n  if (assignedWidth + assignedSpacing < totalWidth) {\r\n    // 计算剩余宽度\r\n    var remainingWidth = totalWidth - (assignedWidth + assignedSpacing);\r\n    \r\n    // 计算当前宽度为1的元素数量\r\n    var countOfOnes = finalWidths.filter(w => w === minWidth).length;\r\n\r\n    // 计算每个段可以增加的间距\r\n    var extraSpacing = Math.floor(remainingWidth / (numberOfSegments - 1));\r\n    if(countOfOnes>1){\r\n        // 如果有元素为1，则平均增加到那些元素上\r\n        var increasePerOne = Math.floor(remainingWidth / countOfOnes);\r\n        for (var i = 0; i < numberOfSegments; i++) {\r\n            if (finalWidths[i] == minWidth) {\r\n                finalWidths[i] += increasePerOne;\r\n            }\r\n        }\r\n    }else{\r\n        // 如果没有元素为1，均匀增加剩余宽度\r\n        var extraWidthPerSegment = Math.floor(remainingWidth / numberOfSegments);\r\n        for (var i = 0; i < numberOfSegments; i++) {\r\n            finalWidths[i] += extraWidthPerSegment;\r\n        }\r\n    }\r\n  }else{\r\n    // 如果总需求加上间距大于总宽度，则按比例缩小宽度\r\n    var widthDecrease = Math.ceil((assignedWidth + assignedSpacing - totalWidth) / numberOfSegments);\r\n    var minval=Math.min(...finalWidths)\r\n    for (var i = 0; i < numberOfSegments; i++) {\r\n        finalWidths[i] -= widthDecrease;\r\n    }\r\n  }\r\n\r\n  // 返回最终宽度数组，确保所有宽度为整数\r\n  var result={\r\n    widths: finalWidths.map(Math.floor).map(w => Math.max(w, 0)),\r\n    spacing:minSpacing,\r\n    sumCout:finalWidths.reduce((a, b) => a + b, 0)\r\n  }\r\n  return result; // 确保返回整数\r\n}\r\n\r\n/**\r\n * 截取数字的小数点后指定的位数（支持负数，且不足位数补零）\r\n * @param {number} num - 要格式化的数字\r\n * @param {number} decimalPlaces - 要保留的小数位数\r\n * @param {boolean} isnum - 是否为数字\r\n * @returns {number} 截取后的小数位数的数字\r\n */\r\nfunction truncateNumber(num, decimalPlaces,isnum) {\r\n  // 处理无效输入\r\n  if (isNaN(num) || isNaN(decimalPlaces)) {\r\n      console.log('Invalid input: num and decimalPlaces must be numbers.');\r\n      return \"\";\r\n  }\r\n  if(decimalPlaces === \"\"){\r\n    return num\r\n  }\r\n  // 确保小数位数为正整数\r\n  decimalPlaces = Math.max(0, Math.floor(decimalPlaces));\r\n\r\n  // 将数字乘以10的decimalPlaces次方并截取\r\n  var factor = Math.pow(10, decimalPlaces);\r\n  var truncated = Math.trunc(num * factor) / factor; // 截取\r\n  if(isnum){\r\n    //返回浮点数，确保尾数正确\r\n    return parseFloat(truncated.toFixed(decimalPlaces));\r\n  }else{\r\n    // 返回字符串，确保尾数正确\r\n    return truncated.toFixed(decimalPlaces)\r\n  }\r\n  \r\n}\r\n\r\n/**\r\n * 转rgba字符串\r\n * @param {number} num - 要格式化的数字\r\n */\r\nfunction colorTostring(array){\r\n  return `rgba(${array[0]},${array[1]},${array[2]},${array[3]})`\r\n}\r\n\r\n// 检查是否可以垂直合并事件\r\nfunction canMergeVerticallys(track, events) {\r\n  return track.every(function(e) {\r\n    return e.end_freq <= events.start_freq || e.start_freq >= events.end_freq;\r\n  });\r\n}\r\n\r\nexport {\r\n  deepMerge,\r\n  deepCopy,\r\n  getDevicePixelRatio,\r\n  calculateStepValues,\r\n  calculateWidths,\r\n  truncateNumber,\r\n  colorTostring,\r\n  canMergeVerticallys\r\n}","import {\r\n  deepMerge,\r\n  deepCopy,\r\n  calculateStepValues,\r\n  calculateWidths,\r\n  truncateNumber,\r\n  colorTostring,\r\n  canMergeVerticallys\r\n} from './utils'\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * freqChart 频率分布图控件\r\n *\r\n * @class freqChart\r\n */\r\nclass freqChart {\r\n  constructor(id, options, treedata) {\r\n    this._isMyClassInstance = true; // 添加标志\r\n    // this.devicePixelRatio = window.devicePixelRatio || 1;\r\n    this.devicePixelRatio = 1;\r\n    //this.loadOptions = options;\r\n    this.box = document.getElementById(id);\r\n    //this.box.style.position = \"relative\"\r\n    // this.box.innerHTML = '';\r\n    var canvasEls = document.querySelectorAll('canvas')\r\n    for (let ids = 0; ids < canvasEls.length; ids++) {\r\n      canvasEls[ids].remove()\r\n    }\r\n    this.canvas = document.createElement('canvas');\r\n    this.canvas.style.position = \"absolute\";\r\n    this.box.appendChild(this.canvas);\r\n    this.ctx = this.canvas.getContext('2d');\r\n    this.ctx.imageSmoothingEnabled = true; // 启用抗锯齿\r\n    //按键容器\r\n    this.bottomBox = document.getElementById('bottomBox');\r\n    this.bottomBox.style.display = \"flex\"; // 显示\r\n    //遮罩\r\n    this.lockBox = document.getElementById('lock_mask');\r\n    //加载进度\r\n    this.loadMask = document.getElementById('onload_mask');\r\n    //滚动条\r\n    this.scrollBar=document.getElementById('scroll-bar');\r\n    this.scrollBarContent=document.getElementById('scroll-bar-content');\r\n    this.scrollBar.style.display = \"none\"; // 隐藏\r\n    this.gridbackground=\"#fff\"\r\n    //分布图数据\r\n    this.treeData = [];\r\n\r\n    this.onFreqChangeCallback = null; //频率改变回调函数\r\n    this.callbackFreq = { //*频率回调函数*/\r\n      min: 0,\r\n      max: 0\r\n    }\r\n    this.onClickGridCallback = null; //点击网格回调函数\r\n    this.onKeyCallback = null; //控制按钮回调函数\r\n    this.onClickZommCallback = null; //点击缩放按钮回调函数\r\n    this.onFocusCallback = null; //控件焦点回调消息\r\n    this.onSwitchCallback = null; //点击切换按钮\r\n    this.zoomStatus = 1\r\n\r\n    this.chartWidth = 0; //图表宽度\r\n    this.chartHeight = 0; //图表高度\r\n    this.xLabelGridInfo = [] //x轴标签网格信息\r\n    this.inittreeData = {}; //初始数据\r\n    this.wifiMaxrows= 0; //类型2wifi 子信道最大行数\r\n    //频率像素比\r\n    this.freqPxStep = 0\r\n    //当前视图频率差\r\n    this.freqXDiff = 0\r\n    //初始默认值\r\n    this.initDefault();\r\n    //初始化配置\r\n    this.initOptions(options);\r\n\r\n    if (treedata) {\r\n      this.readJsonData(treedata)\r\n    }\r\n    //监听事件\r\n    this.canvas.addEventListener('mousedown', this.mousedown.bind(this));\r\n    this.canvas.addEventListener('mouseup', this.mouseup.bind(this))\r\n    this.canvas.addEventListener('mousemove', this.throttle(this.mousemove.bind(this),50));\r\n    this.canvas.addEventListener('mouseout', this.mouseout.bind(this))\r\n    this.canvas.addEventListener('touchstart', this.touchstart.bind(this));\r\n    this.canvas.addEventListener('touchmove', this.throttle(this.touchmove.bind(this),50))\r\n    this.canvas.addEventListener('touchend', this.touchend.bind(this));\r\n    this.canvas.addEventListener('wheel', this.handleWheel.bind(this));\r\n    this.canvas.addEventListener('dblclick', this.handleDblClick.bind(this));\r\n    this.canvas.addEventListener('click', this.handleClick.bind(this));\r\n    document.getElementById('zoom_in').addEventListener('click', (event) => {\r\n      console.log(\"点击缩放了\")\r\n      this.showconsole(\"点击缩放了\")\r\n      event.preventDefault()\r\n      this.setZomm(this.zoomStatus, event);\r\n    }); //1.放大 2.缩小 \r\n    // document.getElementById('zoom_out').addEventListener('click', this.setZomm.bind(this,2)); //缩小\r\n    document.getElementById('switch_button').addEventListener('click', (event) => {\r\n      event.preventDefault()\r\n      this.showconsole(\"点击切换按钮\")\r\n      this.setSwitch(event);\r\n    });\r\n    this.canvas.addEventListener('contextmenu', this.handleContextMenu.bind(this));\r\n    window.addEventListener('keydown', this.handleKeydown.bind(this));\r\n    window.addEventListener('keyup', this.handleKeyup.bind(this));\r\n    // 监听窗口调整大小\r\n    window.addEventListener('resize', () => this.resizeCanvas());\r\n    //window.addEventListener('resize', this.throttle(this.resizeCanvas().bind(this), 300));\r\n\r\n    this.scrollBar.addEventListener('scroll', this.handleScroll.bind(this));\r\n    this.scrollBar.addEventListener('mousedown', this.mousedownScroll.bind(this));\r\n    this.scrollBar.addEventListener('touchstart', this.mousedownScroll.bind(this));\r\n    this.scrollBar.addEventListener('mousemove', this.mousemoveScroll.bind(this));\r\n    this.scrollBar.addEventListener('touchmove', this.mousemoveScroll.bind(this));\r\n    this.scrollBar.addEventListener('mouseup', this.mouseupScroll.bind(this));\r\n    this.scrollBar.addEventListener('touchend', this.mouseupScroll.bind(this));\r\n    //清除焦点class active\r\n    let eleactives = document.querySelectorAll('.active')\r\n    for (let i = 0; i < eleactives.length; i++) {\r\n      eleactives[i].classList.remove('active')\r\n    }\r\n    var buttonfocus = []\r\n    if(this.options.button.show_zoom_button){\r\n      buttonfocus.push({\r\n        \"type\": \"button\",\r\n        \"key\": 'zoomin',\r\n        \"column\": 0,\r\n        \"row\": 0\r\n      })\r\n    }\r\n    if (this.options.button.show_switch_button) {\r\n      var leng=buttonfocus.length\r\n      buttonfocus.push({\r\n        \"type\": \"button\",\r\n        \"key\": 'switch',\r\n        \"column\": 0,\r\n        \"row\": leng\r\n      })\r\n    }\r\n    console.log(\"初始按钮焦点\",buttonfocus)\r\n    // 焦点信息\r\n    this.focusInfo = {\r\n      isLock: false, //是否锁定\r\n      focus: null, //当前焦点\r\n      prefocus: null, //上一个焦点\r\n      list: [buttonfocus]\r\n    };\r\n\r\n    //鼠标按下事件\r\n    this.mousedownInfo = {\r\n      isMouseDown: false,\r\n      startX: 0,\r\n      startY: 0,\r\n      mouseupx: 0,\r\n      mouseupy: 0,\r\n      button: 0\r\n    }\r\n    //鼠标移动事件\r\n    this.moveInfo = {\r\n      isMove: false,\r\n      preX: 0,\r\n      preY: 0,\r\n      moveX: 0,\r\n      moveY: 0\r\n    }\r\n    //鼠标滚轮事件\r\n    this.scrollBarInfo = {\r\n      isMove:false, //是否拖动\r\n    }\r\n    this.drawChart()\r\n  }\r\n\r\n  /**\r\n   * 初始默认参数\r\n   */\r\n  initDefault() {\r\n\r\n    this.isDraw = true\r\n\r\n    // 图像数据\r\n    this.isDragging = false; //是否拖动\r\n    this.isZooming = false; //是否缩放\r\n    this.offsetX = 0; //x轴偏移量\r\n    this.offsetY = 0; //y轴偏移量\r\n    this.scaleX = 1; //x轴缩放比例\r\n    this.scaleY = 1; //y轴缩放比例\r\n    this.scaleDirection = \"x\"; // 缩放方向x|y|both\r\n    this.selectedArea = null; //选中区域\r\n    // 手指双指触摸操作\r\n    this.touchStartDist = 0;\r\n    //记录手指触摸信息\r\n    this.touchStartInfo={\r\n      start_freq:0,//触摸显示开始频率\r\n      end_freq:0,//触摸显示结束频率\r\n      touch_center_freq:0\r\n    }\r\n\r\n    this.prevTouchDistance = 0;\r\n    this.isTouching = false;\r\n\r\n    //移动\r\n    this.touchStartX = 0;\r\n    this.touchStartY = 0;\r\n    this.isTouchDragging = false;\r\n    this.lastTouchDistance = 0; // 上次两个触摸点之间的距离\r\n    this.lastTouchCenterX = 0; // 上次两个触摸点的中心X坐标\r\n\r\n    this.focusType = \"\"; //聚焦类型 grid|left|right|bottom|threshold|marker\r\n    // this.updateScrollbar()\r\n  }\r\n  /**\r\n   * 设置图表大小\r\n   */\r\n  setCanvasSize(widths, heights) {\r\n    const width = widths || this.options.width;\r\n    const height = heights || this.options.height;\r\n    const containerWidth = this.box.clientWidth || 400;\r\n    const containerHeight = this.box.clientHeight || 300;\r\n    // 使用实际像素大小设置 Canvas\r\n    this.canvas.width = width === \"100%\" ? containerWidth : width;\r\n    this.canvas.height = height === \"100%\" ? containerHeight : height;\r\n\r\n    // 设置 CSS 样式，确保 Canvas 在视觉上保持相应比例\r\n    this.canvas.style.width = width === \"100%\" ? `${containerWidth}px` : `${width}px`;\r\n    this.canvas.style.height = height === \"100%\" ? `${containerHeight}px` : `${height}px`;\r\n    this.width = this.canvas.width;\r\n    this.height = this.canvas.height;\r\n\r\n    //计算图表宽高\r\n    this.chartWidth = Math.floor(this.width - this.options.grid.left - this.options.grid.right)\r\n    this.chartHeight = Math.floor(this.height - this.options.grid.top - this.options.grid.bottom)\r\n    this.options.grid.right = this.width - this.options.grid.left - this.chartWidth;\r\n    this.options.grid.bottom = this.height - this.options.grid.top - this.chartHeight;\r\n    document.getElementById(\"bottomBox\").style.height = this.height + \"px\";\r\n    document.getElementById(\"bottomBox\").style.width = this.options.grid.left + \"px\";\r\n\r\n\r\n    this.scrollBar.style.top=this.options.grid.top+\"px\";\r\n    this.scrollBar.style.right=this.options.grid.right+\"px\";\r\n    this.scrollBar.style.height = this.chartHeight + \"px\";\r\n    \r\n\r\n    console.log(\"canvas宽高\", this.canvas.width, this.canvas.height, \"图表宽度\", this.chartWidth);\r\n    // 更新字体大小以适应高分辨率\r\n    //this.options.fontSize = `${parseInt(this.options.fontSize) * window.devicePixelRatio}px`;\r\n  }\r\n  \r\n  /**\r\n   * 初始化配置\r\n   * @param {*} options\r\n   * @memberof freqChart\r\n   */\r\n  initOptions(options,types) {\r\n    let defaultOptions = {\r\n      \"type\": 1, //图表类型 1 2 3 4\r\n      \"width\": \"100%\", //画布宽度\r\n      \"height\": \"100%\", //画布高度\r\n      \"isPrint\": false, //是否允许打印\r\n      \"background\": \"#fff\", //背景色\r\n      \"language_code\": 2052, //语言代码 2052中文 1033英文 0默认 1033\r\n      \"isreadfile\": false, //是否读取文件\r\n      \"channel_show\": \"auto\",//show 显示 hide 隐藏 auto 自动控件控制默认auto\r\n      \"scrollbar_show\": \"auto\",//show 显示 hide 隐藏 auto 自动控件控制默认auto\r\n      \"grid\": { //网格样式\r\n        \"left\": 50, //左边距\r\n        \"top\": 40, //上边距\r\n        \"bottom\": 50, //下边距\r\n        \"right\": 5, //右边距\r\n        \"track_gap\": 0, //行间距\r\n        \"track_title_height\": 30, //标题行高\r\n        \"track_min_height\": 30, //行高\r\n        \"channel_max_height\": 30, //信道道最大高度\r\n        \"track_grid_min_width\": 30, //*最小网格宽度\r\n        \"stroke_color\": [51, 51, 51, 1], //网格线颜色\r\n        \"stroke_width\": 1, //网格线宽度\r\n        \"stroke_focus_width\": 2, //网格线宽度\r\n        \"stroke_focus_color\": [255, 0, 0, 1], //网格线颜色\r\n        \"width\": 1, //网格线宽度\r\n        \"background\": [255, 255, 255, 1], //背景色\r\n      },\r\n      \"x_axis\": { //X轴样式\r\n        \"decimals\": \"\", //X轴刻度标签小数位数\r\n        \"unit\": \"\", //单位MHz 为空不显示 \r\n        \"unit_right\": 10, // x轴单位距离图表左侧距离\r\n        \"unit_position\": \"top\", //单位位置 top顶部 bottom底部\r\n        \"show_top_label\": false, //是否显示顶部标签\r\n        \"show_bottom_label\": false, //是否显示底部标签\r\n        \"init_start_freq\": 10000000, //X轴起始频率\r\n        \"init_end_freq\": 2000000000, //X轴结束频率\r\n        \"start_freq\": 10000000, //X*轴起始频率\r\n        \"end_freq\": 2000000000, //X*轴结束频率\r\n        \"text_color\": [51, 51, 51, 1], //X轴文本颜色\r\n        \"text_font_size\": 12, //X轴文本字体大小\r\n        \"text_font_family\": \"Arial\", //X轴文本字体\r\n        \"color\": \"#333\", //X轴线颜色\r\n        \"width\": 1, //X轴线宽度\r\n        \"item_min_width\": 10, //项最小宽度\r\n        \"labels\": [ //*X轴刻度标签\r\n\r\n        ],\r\n      },\r\n      \"button\": {\r\n        \"show_zoom_button\": true, //是否显示缩放按钮\r\n        \"background_button\": [252, 176, 64, 1], //按钮背景色\r\n        \"show_switch_button\": true, //是否显示切换按钮\r\n      },\r\n      \"lock\": { //锁屏样式\r\n        \"content\": \"\",\r\n        \"font_size\": 40, //图标字体大小\r\n        \"color\": [255, 255, 255, 1], //字体颜色\r\n        \"background\": [0, 60, 136, 0.5] //背景颜色\r\n      },\r\n      //X轴标签\r\n      \"label_angle\": 90, //*X轴刻度标签角度\r\n      \"tree_data\": {}, //数据\r\n    }\r\n    const mergedOptions = deepMerge({}, defaultOptions);\r\n    this.options = deepMerge(mergedOptions, options);\r\n    //初始化参数和DPR计算\r\n    this.options.grid.left = Math.floor(this.options.grid.left * this.devicePixelRatio);\r\n    if (this.options.x_axis.show_bottom_label) {\r\n      this.options.grid.bottom = Math.floor(this.options.grid.bottom * this.devicePixelRatio);\r\n    } else {\r\n      this.options.grid.bottom = 0\r\n    }\r\n    if (this.options.x_axis.show_top_label) {\r\n      this.options.grid.top = Math.floor(this.options.grid.top * this.devicePixelRatio);\r\n    } else {\r\n      this.options.grid.top = 0\r\n    }\r\n    this.options.grid.right = Math.floor(this.options.grid.right * this.devicePixelRatio);\r\n    \r\n    \r\n    // 获取子元素\r\n    const buttons = this.bottomBox.getElementsByClassName(\"button\");\r\n    for (let i = 0; i < buttons.length; i++) {\r\n      buttons[i].style.flex = \"1\"; // 子元素动态分配高度\r\n      buttons[i].style.backgroundColor = colorTostring(this.options.button.background_button); //设置按钮背景色\r\n    }\r\n    this.zoomBox = document.getElementById('zoom_in');\r\n    if (this.options.button.show_zoom_button) { //显示缩放按钮\r\n      this.zoomBox.style.display = \"flex\"\r\n    }\r\n    if (this.options.button.show_switch_button) { //显示切换按钮\r\n      this.switchBox = document.getElementById('switch_button');\r\n      this.switchBox.style.display = \"flex\"\r\n    }\r\n    if(types!==\"update\"){\r\n      this.options.x_axis.start_freq = this.options.x_axis.init_start_freq;\r\n      this.options.x_axis.end_freq = this.options.x_axis.init_end_freq;\r\n    }\r\n    this.xLabelGridInfo = [] //x轴标签网格信息\r\n    this.setCanvasSize();\r\n    console.log(\"初始化配置\", this.options)\r\n  }\r\n  /**\r\n   * 读取json数据重置\r\n   * @param {*} datas \r\n   * @returns \r\n   */\r\n  readJsonData(datas) {\r\n    if (!datas) {\r\n      return false\r\n    }\r\n    this.inittreeData = datas;\r\n    this.options.type = datas.format_type || this.options.type;\r\n    this.gridbackground = datas.bg_color || \"#fff\"; //背景色\r\n    console.log(\"读取数据背景色\",datas.bg_color, this.gridbackground,datas)\r\n    //console.log(\"读取数据设置类型\", this.options.type)\r\n    //console.log(\"读取数据\", band_list)\r\n\r\n    // if (this.options.isreadfile) {\r\n    //   var freqRange = this.getFreqRange(datas.band_list);\r\n    //   if (freqRange) {\r\n    //     this.options.x_axis.init_start_freq = freqRange.min;\r\n    //     this.options.x_axis.init_end_freq = freqRange.max;\r\n    //     this.options.x_axis.start_freq = freqRange.min;\r\n    //     this.options.x_axis.end_freq = freqRange.max;\r\n    //     this.scaleX = 1;\r\n    //     this.scaleY = 1;\r\n    //   } else {\r\n    //     console.log(\"获取大小失败\")\r\n    //   }\r\n    // }\r\n\r\n  }\r\n  //初始化数据\r\n  initData(datas) {\r\n    let band_list = JSON.parse(JSON.stringify(datas.band_list));\r\n    var start = performance.now();\r\n    // let band_list = datas.band_list;\r\n    console.log(\"band_list\", band_list, this.inittreeData)\r\n\r\n    let initgrid = []\r\n    if (this.options.type == 1) {\r\n      //初始id 计算宽高\r\n      var griddatas = this.getRegionData(band_list, this.options.x_axis.start_freq, this.options.x_axis.end_freq);\r\n      initgrid = this.calculateItemData(griddatas)\r\n      griddatas = null; //释放内存\r\n      //this.showconsole('计算网格1类型网格: ' + (performance.now() - start).toFixed(3) + 'ms')\r\n    } else {\r\n      //初始id 计算宽高\r\n      var initgridFreq = this.getRegionData(band_list, this.options.x_axis.init_start_freq, this.options.x_axis.init_end_freq);\r\n      if(this.options.type == 2){\r\n        this.getMaxRowNum(initgridFreq)\r\n      }\r\n      //this.showconsole('计算网格其他类型过滤: ' + (performance.now() - start).toFixed(3) + 'ms')\r\n      var initlaydata = this.layoutEvents(initgridFreq)\r\n      console.log(\"布局布局数据布局数据数据\", initlaydata)\r\n      //this.showconsole('计算网格其他类型布局: ' + (performance.now() - start).toFixed(3) + 'ms')\r\n      var layoutArr = []\r\n      for (let i = 0; i < initlaydata.length; i++) {\r\n        // layoutArr.push(this.layoutEvents(initlaydata[i]))\r\n        layoutArr.push([initlaydata[i]])\r\n      }\r\n      console.log(\"布局数据\", layoutArr)\r\n      initgrid = this.initCulateItemData(layoutArr)\r\n      initgridFreq = null; //释放内存\r\n      layoutArr = null\r\n      //this.showconsole('计算网格其他类型网格: ' + (performance.now() - start).toFixed(3) + 'ms')\r\n    }\r\n    this.initFocusList(initgrid, this.options.type)\r\n    //this.showconsole('计算网格其他类型焦点数据: ' + (performance.now() - start).toFixed(3) + 'ms')\r\n    this.treeData.length = 0; //清空数据\r\n    this.treeData = initgrid;\r\n    console.log(\"数据初始化成功\", this.treeData)\r\n    band_list = null;\r\n    initgrid = null;\r\n  }\r\n  /**\r\n   * 获取区域数据\r\n   * @param {*} datas\r\n   * @returns\r\n   */\r\n  getRegionData(datas, limit_start_freq, limit_end_freq) {\r\n    let regionData = [];\r\n    for (let i = 0; i < datas.length; i++) {\r\n      let data = datas[i];\r\n      let start_freq = data.start_freq;\r\n      let end_freq = data.end_freq\r\n      //if(end_freq<=this.options.x_axis.end_freq&&end_freq>=this.options.x_axis.start_freq){\r\n      if(end_freq<limit_start_freq){\r\n        continue;\r\n      }else if (end_freq >= limit_start_freq && start_freq <= limit_end_freq) {\r\n        regionData.push(data)\r\n      }else if(start_freq>limit_end_freq){\r\n        continue;\r\n      }\r\n    }\r\n    return regionData\r\n  }\r\n  /**\r\n   * 获取子信道行数\r\n   * @param {*} datas \r\n   */\r\n  getMaxRowNum(datas) {\r\n    console.log(\"获取子信道行数\", datas)\r\n    let maxRowNum = 0;\r\n    for (let i = 0; i < datas.length; i++) {\r\n      let data = datas[i];\r\n      if(data.child_band&&data.child_band.length>maxRowNum){\r\n        maxRowNum = data.child_band.length\r\n      }\r\n    }\r\n    this.wifiMaxrows= maxRowNum\r\n  }\r\n  /**\r\n   * 初始焦点项\r\n   * @param {*} datas \r\n   */\r\n  initFocusList(datas, types) {\r\n    this.focusInfo.list.splice(1)\r\n    let columnRow = []\r\n    for (let i = 0; i < datas.length; i++) {\r\n      let data = datas[i];\r\n      let focusArr = []\r\n      let rows = []\r\n      if (types == 1) {\r\n        rows = data.business\r\n      } else {\r\n        rows = data\r\n      }\r\n      for (let j = 0; j < rows.length; j++) {\r\n        let row = rows[j]\r\n        //类型1 为竖排 其他类型横排\r\n        let focusitem = {}\r\n        if (types == 1) {\r\n          focusitem = {\r\n            \"direction\": \"vertical\", //竖排\r\n            \"type\": \"grid\",\r\n            \"key\": row.orderid,\r\n            \"column\": i + 1,\r\n            \"row\": j\r\n          }\r\n          focusArr.push(focusitem)\r\n        } else {\r\n          focusitem = {\r\n            \"direction\": \"horizontal\", //横排\r\n            \"type\": \"grid\",\r\n            \"key\": row.orderid,\r\n            \"column\": j + 1,\r\n            \"row\": i\r\n          }\r\n          // if(this.options.type == 2){\r\n          //   focusitem.childfocus=this.childFocus()\r\n          // }\r\n          focusArr.push(focusitem)\r\n        }\r\n\r\n        //更新焦点项\r\n        if (this.focusInfo.focus && this.focusInfo.focus.type == row.orderid) {\r\n          this.focusInfo.focus = focusitem\r\n        }\r\n      }\r\n      if (types == 1) {\r\n        this.focusInfo.list.push(focusArr)\r\n      } else {\r\n        columnRow.push(focusArr)\r\n      }\r\n    }\r\n    if (types !== 1) {\r\n      var maxLength = 0;\r\n      for (var l = 0; l < columnRow.length; l++) {\r\n        if (columnRow[l].length > maxLength) {\r\n          maxLength = columnRow[l].length;\r\n        }\r\n      }\r\n\r\n      // 转置操作，去除 null 值\r\n      var transposedArray = [];\r\n      for (var d = 0; d < maxLength; d++) {\r\n        var newRow = [];\r\n        for (var k = 0; k < columnRow.length; k++) {\r\n          if (columnRow[k][d] !== undefined) {\r\n            newRow.push(columnRow[k][d]); // 只有非 undefined（非 null）的值才会被加入\r\n          }\r\n        }\r\n        if (newRow.length > 0) { // 只有当新行中有有效值时才添加到结果数组中\r\n          transposedArray.push(newRow);\r\n        }\r\n      }\r\n      transposedArray.forEach((item, index) => {\r\n        this.focusInfo.list.push(item)\r\n      })\r\n    }\r\n    columnRow=null;\r\n    //console.log(\"更新焦点项\", this.focusInfo.list)\r\n  }\r\n\r\n  /**\r\n   * 计算项宽度数据\r\n   */\r\n  calculateItemData(datas) {\r\n    // let basicWidth = this.options.x_axis.item_min_width\r\n    // let newchartWidth = this.chartWidth - basicWidth * datas.length;\r\n    let chartWidths = this.chartWidth;\r\n    let freqdiff = this.options.x_axis.end_freq - this.options.x_axis.start_freq;\r\n    let freqStep = chartWidths / freqdiff;\r\n    this.freqPxStep = freqdiff / chartWidths\r\n    this.freqXDiff = freqdiff\r\n    let gridData = [];\r\n    //this.focusInfo.list.splice(1)\r\n    for (let i = 0; i < datas.length; i++) {\r\n      let data = datas[i];\r\n      let start_freq = data.start_freq;\r\n      let end_freq = data.end_freq;\r\n      let start_x = (start_freq - this.options.x_axis.start_freq) * freqStep;\r\n      let end_x = (end_freq - this.options.x_axis.start_freq) * freqStep;\r\n      let width = end_x - start_x;\r\n      let label_start_x = start_freq;\r\n      let label_start_freq = start_freq;\r\n      let label_end_x = end_x;\r\n      let label_end_freq = end_freq;\r\n      data.type = \"column\";\r\n      data.column_id = i;\r\n      if (start_freq < this.options.x_axis.start_freq && end_freq >= this.options.x_axis.start_freq && end_freq <= this.options.x_axis.end_freq) {\r\n        start_x = 0;\r\n        label_start_x = 0;\r\n        width = end_x - start_x;\r\n        label_start_freq = this.options.x_axis.start_freq;\r\n      } else if (start_freq <= this.options.x_axis.end_freq && start_freq >= this.options.x_axis.start_freq && end_freq > this.options.x_axis.end_freq) {\r\n        end_x = (this.options.x_axis.end_freq - this.options.x_axis.start_freq) * freqStep;\r\n        width = end_x - start_x;\r\n        label_end_x = end_x\r\n        label_end_freq = this.options.x_axis.end_freq;\r\n      } else if (start_freq < this.options.x_axis.start_freq && end_freq > this.options.x_axis.end_freq) {\r\n        start_x = 0;\r\n        end_x = (this.options.x_axis.end_freq - this.options.x_axis.start_freq) * freqStep;\r\n        width = end_x - start_x;\r\n        label_start_x = 0;\r\n        label_start_freq = this.options.x_axis.start_freq;\r\n        label_end_x = end_x\r\n        label_end_freq = this.options.x_axis.end_freq;\r\n      }\r\n      data.start_x = start_x;\r\n      data.label_start_x = start_x;\r\n      data.label_start_freq = label_start_freq;\r\n      data.label_end_x = end_x;\r\n      data.label_end_freq = label_start_freq;\r\n      data.width = width;\r\n      data.height = this.chartHeight * this.scaleY;\r\n      data.end_x = end_x;\r\n      let rows = data.business\r\n      let rowHeight = this.chartHeight * this.scaleY / rows.length;\r\n      //let focusArr=[]\r\n      //console.log(\"计算区域高度\",rowHeight,this.scaleY,this.offsetY)\r\n      for (let j = 0; j < rows.length; j++) {\r\n        let row = rows[j];\r\n        row.type = \"item\";\r\n        row.orderid = i + \"_\" + j;\r\n        row.column_id = i;\r\n        row.item_id = j\r\n        row.width = width;\r\n        row.height = rowHeight;\r\n        row.start_freq=start_freq;\r\n        row.end_freq=end_freq;\r\n        row.start_x = start_x;\r\n        row.end_x = end_x;\r\n        row.parent_foot_notes = data.foot_notes;\r\n        row.x = row.start_x + this.offsetX + this.options.grid.left;\r\n        row.y = this.options.grid.top + rowHeight * j + this.offsetY;\r\n        row.color = this.getItemColor(row.business_id)\r\n        row.text = [this.getItemText(row.business_id)]\r\n        //console.log(\"获取文字内容\",row.business_id,row.text)\r\n\r\n      }\r\n      gridData.push(data)\r\n    }\r\n    return gridData\r\n  }\r\n  /**\r\n   * 计算其他类型行宽数据\r\n   * @param {*} datas \r\n   * @returns \r\n   */\r\n\r\n  initCulateItemData(datas, typestr) {\r\n    //console.log(\"其他计算行宽数据\", datas, typestr)\r\n    let chartWidths = this.chartWidth;\r\n    let freqdiff = this.options.x_axis.end_freq - this.options.x_axis.start_freq;\r\n    let freqStep = chartWidths / freqdiff;\r\n    this.freqPxStep = freqdiff / chartWidths\r\n    this.freqXDiff = freqdiff\r\n    let gridData = [];\r\n    let trackGap = this.options.grid.track_gap || 0; //间隙\r\n    // if(this.options.type == 2){\r\n    //   trackTitleHeight = this.options.grid.track_title_height || 30; //标题高\r\n    // }\r\n    let trackHeight = (this.chartHeight - (datas.length - 1) * trackGap) / datas.length; //行高\r\n    if (typestr == \"childwifi\") {\r\n      trackGap = 0;\r\n      var rowsNum= this.wifiMaxrows || datas.length; //行数\r\n      trackHeight = (this.chartHeight - (rowsNum - 1) * trackGap) / (rowsNum+1); //行高\r\n      console.log(\"计算行高\", trackHeight, rowsNum, this.wifiMaxrows)\r\n    }\r\n    \r\n    //增加一行标题行\r\n    \r\n    let rowHeight = trackHeight * this.scaleY;\r\n    \r\n    let rowTitleHeight = 0; //标题行高\r\n    if (typestr == \"childwifi\") {\r\n      if(rowHeight>this.options.grid.channel_max_height){\r\n        rowHeight=this.options.grid.channel_max_height;\r\n      }\r\n      rowTitleHeight = rowHeight\r\n      this.options.grid.track_title_height=rowTitleHeight\r\n    }\r\n    for (let i = 0; i < datas.length; i++) {\r\n      let rowarr=datas[i];\r\n      if (typestr == \"childwifi\") {\r\n        rowarr = [datas[i].child_band_ranges]\r\n        \r\n      }\r\n      for (let d = 0; d < rowarr.length; d++) {\r\n        let rows = rowarr[d];\r\n        //行数据\r\n        let rowdata = []\r\n        for (let j = 0; j < rows.length; j++) {\r\n          \r\n          let data = rows[j];\r\n          if (data.sub_title!= undefined) {\r\n            data.sub_title_height = rowTitleHeight;\r\n          }\r\n          let start_freq = data.start_freq;\r\n          let end_freq = data.end_freq;\r\n          let start_x = (start_freq - this.options.x_axis.start_freq) * freqStep;\r\n          let end_x = (end_freq - this.options.x_axis.start_freq) * freqStep;\r\n          let width = end_x - start_x;\r\n          let label_start_x = start_freq;\r\n          let label_start_freq = start_freq;\r\n          let label_end_x = end_x;\r\n          let label_end_freq = end_freq;\r\n\r\n          if (start_freq < this.options.x_axis.start_freq && end_freq >= this.options.x_axis.start_freq && end_freq <= this.options.x_axis.end_freq) {\r\n            start_x = 0;\r\n            width = end_x - start_x;\r\n            label_start_freq = this.options.x_axis.start_freq;\r\n          } else if (start_freq <= this.options.x_axis.end_freq && start_freq >= this.options.x_axis.start_freq && end_freq > this.options.x_axis.end_freq) {\r\n            end_x = (this.options.x_axis.end_freq - this.options.x_axis.start_freq) * freqStep;\r\n            width = end_x - start_x;\r\n            label_end_x = end_x\r\n            label_end_freq = this.options.x_axis.end_freq;\r\n          } else if (start_freq < this.options.x_axis.start_freq && end_freq > this.options.x_axis.end_freq) {\r\n            start_x = 0;\r\n            end_x = (this.options.x_axis.end_freq - this.options.x_axis.start_freq) * freqStep;\r\n            width = end_x - start_x;\r\n            label_start_freq = this.options.x_axis.start_freq;\r\n            label_end_x = end_x\r\n            label_end_freq = this.options.x_axis.end_freq;\r\n          }\r\n          data.type = \"item\";\r\n          data.column_id = j + 1;\r\n          data.orderid = data.column_id + \"_\" + i;\r\n          if (typestr == \"childwifi\") {\r\n            data.childtype = \"childband\"\r\n            data.parent_orderid = datas[i].parent_orderid;\r\n            data.parent_foot_notes = datas[i].parent_foot_notes;\r\n            data.orderid = datas[i].parent_orderid + \"_\" + data.orderid\r\n          }\r\n          data.item_id = i;\r\n          data.label_start_x = start_x;\r\n          data.label_start_freq = label_start_freq;\r\n          data.label_end_x = end_x;\r\n          data.label_end_freq = label_end_freq;\r\n          data.width = width;\r\n          data.height = rowHeight;\r\n          data.start_x = start_x;\r\n          data.end_x = end_x;\r\n          data.x = data.start_x + this.offsetX + this.options.grid.left;\r\n          data.y = this.options.grid.top + (rowHeight + trackGap) * i + this.offsetY+ rowTitleHeight;\r\n          if (this.options.type == 3) {\r\n            data.color = data.color;\r\n            var texts = \"\";\r\n            data.language.forEach((item) => {\r\n                if (item.code == this.options.language_code) {\r\n                  texts = item.name;\r\n                }\r\n              })\r\n            // try {\r\n            //   data.language.forEach((item) => {\r\n            //     if (item.code == this.options.language_code) {\r\n            //       texts = item.name;\r\n            //     }\r\n            //   })\r\n            // } catch (error) {\r\n            //   console.log(\"获取语言失败\", error,data)\r\n              \r\n            // }\r\n            \r\n            data.text = [texts];\r\n          }\r\n          //  else if (this.options.type == 4){\r\n          //   data.color = this.getItemColor(data.business_id)\r\n          //   var texts = this.getItemText(data.business_id)\r\n          //   texts+=data.sub_title\r\n          //   data.text = [texts];\r\n          // } \r\n          else if (typestr == \"childwifi\") {\r\n            data.color = datas[i].color;\r\n            data.text = [data.business_name];\r\n          } else {\r\n            data.color = this.getItemColor(data.business_id)\r\n            data.text = [this.getItemText(data.business_id)]\r\n            if(data.sub_title!= undefined){\r\n              data.text.push(data.sub_title)\r\n            }\r\n          }\r\n          //wifi 子信道初始化数据\r\n          if (this.options.type == 2 && data.child_band) {\r\n            let childTreeData = data.child_band\r\n            childTreeData.forEach((item) => {\r\n              item.x = data.x;\r\n              item.y = data.y;\r\n              item.width = data.width;\r\n              item.height = rowHeight;\r\n              item.start_x = data.start_x;\r\n              item.end_x = data.end_x;\r\n              item.parent_orderid = data.orderid;\r\n              item.parent_foot_notes = data.foot_notes;\r\n              item.child_band_ranges = this.getRegionData(item.child_band_range, this.options.x_axis.start_freq, this.options.x_axis.end_freq)\r\n              //console.log(\"过滤子信道道数据\",item.child_band_ranges)\r\n              \r\n            })\r\n            //console.log(\"子信道init行数据\",childinitData)\r\n            data.child_business_list = this.initCulateItemData(childTreeData, \"childwifi\")\r\n            \r\n          }\r\n\r\n          rowdata.push(data)\r\n          //子信道解析数据\r\n        }\r\n        gridData.push(rowdata)\r\n      }\r\n    }\r\n    return gridData\r\n  }\r\n\r\n  /**\r\n   * 绘制图表\r\n   */\r\n  drawCharts() {\r\n    console.log(\"开始绘制图表\",new Date().getTime())\r\n    this.setLoadMask(true)\r\n    var start = performance.now(); // 高精度时间戳\r\n    //this.showconsole('开始绘制图表',start)\r\n    this.clearCanvas();\r\n    this.initBackground();\r\n    // this.debounce(this.initData(this.inittreeData).bind(this), 100) //延时绘制\r\n    this.initData(this.inittreeData)\r\n\r\n    this.showconsole('数据处理总时长: ' + (performance.now() - start).toFixed(3) + 'ms')\r\n    this.drawAxis();\r\n    //this.showconsole('drawAxis绘制总时长: ' + (performance.now() - start).toFixed(3) + 'ms')\r\n    this.drawGrid();\r\n    this.showconsole('绘制总时长: ' + (performance.now() - start).toFixed(3) + 'ms')\r\n    this.setLoadMask(false)\r\n    this.updateScrollbar(); //更新滚动条\r\n  }\r\n   drawChart(){\r\n    this.debounce(this.drawCharts(), 500) //延时绘制\r\n   }\r\n  /**\r\n   *清空画布\r\n   */\r\n  clearCanvas() {\r\n    this.ctx.clearRect(0, 0, this.width, this.height);\r\n  }\r\n  /**\r\n   * 初始化背景\r\n   */\r\n  initBackground() {\r\n   // this.ctx.fillStyle = colorTostring(this.options.background);\r\n    this.ctx.fillStyle = this.gridbackground;\r\n    this.ctx.fillRect(0, 0, this.width, this.height);\r\n  }\r\n\r\n\r\n\r\n\r\n  /**\r\n   * 初始化图表\r\n   */\r\n  drawAxis() {\r\n    // 绘制x轴\r\n    this.initdrawData();\r\n    this.selcetedFocus();\r\n    this.ctx.strokeStyle = colorTostring(this.options.x_axis.color);\r\n    this.ctx.lineWidth = 1;\r\n    this.ctx.beginPath();\r\n    this.ctx.moveTo(this.options.grid.left, this.height - this.options.grid.bottom);\r\n    this.ctx.lineTo(this.width - this.options.grid.right, this.height - this.options.grid.bottom);\r\n    this.ctx.stroke();\r\n\r\n    // 绘制x轴标签\r\n    this.ctx.fillStyle = colorTostring(this.options.x_axis.text_color);\r\n    this.ctx.textBaseline = 'top';\r\n    this.ctx.font = `${this.options.x_axis.text_font_size * this.devicePixelRatio}px ${this.options.x_axis.text_font_family}`;\r\n    // 绘制底部文字\r\n    if (this.options.x_axis.show_bottom_label) {\r\n      this.options.x_axis.labels.forEach((data, index) => {\r\n        var x = 0;\r\n        var y = this.height - this.options.grid.bottom + 8;\r\n        const texts = truncateNumber(data.text / 1000000, this.options.x_axis.decimals);\r\n        if (index == 0) {\r\n          x = this.options.grid.left;\r\n        } else {\r\n          x = this.width - this.options.grid.right - this.ctx.measureText(texts).width;\r\n        }\r\n\r\n        this.ctx.fillText(texts, x, y);\r\n\r\n      })\r\n    }\r\n    // 绘制X轴单位\r\n    if (this.options.x_axis.unit !== \"\") {\r\n      let pointx = this.width - this.options.grid.right - this.options.x_axis.unit_right - this.ctx.measureText(this.options.x_axis.unit).width;\r\n      // 根据 unit_position 的值调整 y 坐标\r\n      let pointy;\r\n      switch (this.options.x_axis.unit_position) {\r\n        case 'top': // 在右上角显示\r\n          pointy = this.options.grid.top - this.options.x_axis.text_font_size - 14; // 距离顶部一定距离\r\n          break;\r\n        case 'bottom': // 在右下角显示\r\n          pointy = this.height - this.options.grid.bottom + this.options.x_axis.text_font_size + 8; // 距离底部一定距离\r\n          break;\r\n        default: // 默认在右下角显示\r\n          pointy = this.height - this.options.grid.bottom + this.options.x_axis.text_font_size + 8;\r\n          break;\r\n      }\r\n      this.ctx.fillText(this.options.x_axis.unit, pointx + 8, pointy);\r\n    }\r\n    // 绘制顶部文字\r\n    \r\n    if (this.options.x_axis.show_top_label) { // 是否显示顶部标签\r\n      let treeData = this.treeData;\r\n      for (let i = 0; i < treeData.length; i++) {\r\n        const columnData = treeData[i];\r\n        if(Array.isArray(columnData)){\r\n          //console.log(\"绘制顶部标签数据异常\", columnData)\r\n          continue;\r\n        }\r\n        if (treeData.length == 1) {\r\n          this.drawItemText(columnData.label_start_freq, columnData.label_start_x + this.options.grid.left, this.options.grid.top - 14);\r\n          this.drawItemText(columnData.label_end_freq, columnData.label_end_x + this.options.grid.left - 10, this.options.grid.top - 14);\r\n        } else if (treeData.length > 1) {\r\n          if (i == 0) {\r\n            this.drawItemText(columnData.label_start_freq, columnData.label_start_x + this.options.grid.left, this.options.grid.top - 14);\r\n          } else if (i < treeData.length - 1) {\r\n            this.drawItemText(columnData.label_start_freq, columnData.label_start_x + this.options.grid.left, this.options.grid.top - 14);\r\n          } else if (i == treeData.length - 1) {\r\n            this.drawItemText(columnData.label_start_freq, columnData.label_start_x + this.options.grid.left, this.options.grid.top - 14);\r\n            this.drawItemText(columnData.label_end_freq, columnData.label_end_x + this.options.grid.left - 30, this.options.grid.top - 14);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    // this.ctx.save(); // 保存当前绘图状态\r\n    //         this.ctx.translate(x, y); // 原点移动到移动到标签位置\r\n    //         this.ctx.rotate(angleInRadians); // 应用旋转变换\r\n    //         this.ctx.fillText(texts, 0, 0); // 绘制旋转后的文字\r\n    //         this.ctx.restore(); // 恢复上下文状态\r\n    // this.ctx.textAlign = 'center';\r\n    // let halfWidth = this.ctx.measureText(texts).width / 2\r\n  }\r\n\r\n  /**\r\n   * 初始绘制数据\r\n   */\r\n  initdrawData() {\r\n    //计算x轴标签底部\r\n    let labelx_axis = [{\r\n      offsetx: 0,\r\n      text: this.options.x_axis.start_freq\r\n    }, {\r\n      offsetx: this.chartWidth + this.options.grid.left,\r\n      text: this.options.x_axis.end_freq\r\n    }]\r\n    this.options.x_axis.labels = labelx_axis;\r\n  }\r\n  /**\r\n   * 绘制网格\r\n   */\r\n  drawGrid() {\r\n    //this.ctx.fillStyle = colorTostring(this.options.grid.background);\r\n    this.ctx.fillStyle = this.gridbackground;\r\n    console.log(\"绘制背景色\", this.gridbackground)\r\n    this.ctx.fillRect(this.options.grid.left, this.options.grid.top, this.chartWidth, this.chartHeight);\r\n    this.ctx.strokeStyle = colorTostring(this.options.grid.stroke_color);\r\n    this.ctx.lineWidth = this.options.grid.stroke_width;\r\n\r\n    this.ctx.save();\r\n    this.ctx.beginPath();\r\n    this.ctx.rect(\r\n      this.options.grid.left,\r\n      this.options.grid.top,\r\n      this.chartWidth,\r\n      this.chartHeight\r\n    );\r\n    // 裁剪谱线超过图表区域的部分\r\n    this.ctx.clip();\r\n    this.ctx.beginPath();\r\n    var strokeWidth = this.options.grid.stroke_width || 2;\r\n    this.ctx.lineWidth = strokeWidth;\r\n    let isHaveselectedArea = false; //是否已经绘制了选中的区域\r\n    for (let i = 0; i < this.treeData.length; i++) {\r\n      let itemArray = []\r\n      if (this.options.type !== 1) {\r\n        itemArray = this.treeData[i]\r\n      } else {\r\n        itemArray = this.treeData[i].business;\r\n      }\r\n      for (let j = 0; j < itemArray.length; j++) {\r\n        let row = itemArray[j];\r\n        let x = row.x;\r\n        let y = row.y;\r\n        let width = row.width;\r\n        let height = row.height;\r\n        this.ctx.fillStyle = row.color;\r\n        this.ctx.fillRect(x, y, width, height);\r\n        this.ctx.strokeStyle = this.options.grid.stroke_color || '#333';\r\n        this.ctx.setLineDash([]);\r\n        this.ctx.lineWidth = strokeWidth;\r\n        // 绘制区域边框\r\n        if (this.focusInfo.focus && this.focusInfo.focus.key == row.orderid) {\r\n          // 高亮选中的区域\r\n          isHaveselectedArea = true;\r\n          this.selectedArea = row\r\n        }\r\n        this.ctx.strokeRect(x + strokeWidth / 2, y + strokeWidth / 2, width - strokeWidth, height - strokeWidth);\r\n        // 绘制文字\r\n        //console.log(\"绘制项\",row)\r\n\r\n        if(this.options.type == 2&&this.options.channel_show==\"show\"){\r\n          this.drawTree(row.child_business_list)\r\n          this.drawTexts(row.text, x, y, width, this.options.grid.track_title_height);\r\n        //}else if(this.options.type == 2&&this.options.channel_show==\"auto\"&&row.child_business_list && row.child_business_list.length > 0 && height > row.child_business_list.length * this.options.grid.track_min_height && width > 60) {\r\n        }else if(this.options.type == 2&&this.options.channel_show==\"auto\"&&row.child_business_list && row.child_business_list.length > 0 && height > 18 && width > 50) {\r\n        \r\n          //this.showconsole(row.text+\"满足条件绘制子信道长度\")\r\n              this.drawTree(row.child_business_list)\r\n              this.drawTexts(row.text, x, y, width, this.options.grid.track_title_height);\r\n        }else{\r\n          this.drawTexts(row.text, x, y, width, height);\r\n        }\r\n      }\r\n    }\r\n    // 高亮选中的区域\r\n    if (this.selectedArea && isHaveselectedArea) {\r\n      this.ctx.strokeStyle = colorTostring(this.options.grid.stroke_focus_color);\r\n      this.ctx.setLineDash([]);\r\n      this.ctx.lineWidth = this.options.grid.stroke_focus_width;\r\n      var x = this.selectedArea.x;\r\n      var y = this.selectedArea.y;\r\n      let width = this.selectedArea.width;\r\n      let height = this.selectedArea.height;\r\n      this.ctx.strokeRect(x + 0.5, y + 0.5, width - 1, height - 1);\r\n      console.log(\"绘制选中11111区域\",this.selectedArea)\r\n    }\r\n    this.ctx.restore();\r\n  }\r\n\r\n  drawTree(treeDatas) {\r\n    //console.log(\"绘制子信道数据\", treeDatas)\r\n    let strokeWidth = 1;\r\n    for (let i = 0; i < treeDatas.length; i++) {\r\n      let itemArray = treeDatas[i]\r\n      if(treeDatas[i].length<1){\r\n        continue;\r\n      }\r\n      let rowwidth=itemArray[treeDatas[i].length-1].end_x-itemArray[0].x+this.options.grid.left;\r\n      this.ctx.fillStyle = itemArray[0].color;\r\n      this.ctx.fillRect(itemArray[0].x, itemArray[0].y, rowwidth, itemArray[0].height);\r\n      this.ctx.lineWidth = strokeWidth;\r\n      this.ctx.strokeStyle = '#666';\r\n      this.ctx.setLineDash([5, 5], 0); // 设置虚线样式\r\n      this.ctx.strokeRect(itemArray[0].x + strokeWidth / 2, itemArray[0].y + strokeWidth / 2, rowwidth - strokeWidth, itemArray[0].height - strokeWidth);\r\n\r\n      for (let j = 0; j < itemArray.length; j++) {\r\n        let row = itemArray[j];\r\n        let x = row.x;\r\n        let y = row.y;\r\n        let width = row.width;\r\n        let height = row.height;\r\n        this.drawTexts(row.text, x, y, width, height);\r\n        if(j>0){\r\n          //绘制垂直虚线\r\n          this.ctx.strokeStyle = '#666';\r\n          this.ctx.beginPath();\r\n          this.ctx.moveTo(x,y);\r\n          this.ctx.lineTo(x,y+height)\r\n          this.ctx.stroke();\r\n        }\r\n      }\r\n      itemArray = null;\r\n    }\r\n  }\r\n  drawTrees(treeDatas) {\r\n    console.log(\"绘制子信道数据\", treeDatas)\r\n    let strokeWidth = 1;\r\n    for (let i = 0; i < treeDatas.length; i++) {\r\n      let itemArray = treeDatas[i]\r\n      // this.ctx.fillStyle = itemDatas.color;\r\n      // let childItem=itemArray[0]\r\n      // this.ctx.fillRect(itemDatas.x, childItem.y, itemDatas.width, childItem.height);\r\n\r\n      \r\n      // if(itemArray.length>0){\r\n      //   this.ctx.fillStyle = itemArray[0].color;\r\n      // }\r\n      \r\n      for (let j = 0; j < itemArray.length; j++) {\r\n        let row = itemArray[j];\r\n        let x = row.x;\r\n        let y = row.y;\r\n        let width = row.width;\r\n        let height = row.height;\r\n        this.ctx.fillStyle = row.color;\r\n        this.ctx.fillRect(x, y, width, height);\r\n        this.ctx.lineWidth = strokeWidth;\r\n        this.ctx.strokeStyle = '#666';\r\n        this.ctx.setLineDash([5, 5], 0); // 设置虚线样式\r\n        // 绘制区域边框\r\n        if (this.focusInfo.focus && this.focusInfo.focus.key == row.orderid) {\r\n          // 高亮选中的区域\r\n          isHaveselectedArea = true;\r\n          this.selectedArea = row\r\n          console.log(\"绘制选中区域\", this.selectedArea)\r\n        }\r\n        this.ctx.strokeRect(x + strokeWidth / 2, y + strokeWidth / 2, width - strokeWidth, height - strokeWidth);\r\n        // 绘制文字\r\n        // console.log(\"绘制项\",row)\r\n        this.drawTexts(row.text, x, y, width, height);\r\n      }\r\n      itemArray = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 获取频谱图颜色\r\n   * @param {*} id \r\n   */\r\n\r\n  getItemColor(id) {\r\n    let listdata = this.inittreeData.business_list;\r\n    let color = \"#ddd\";\r\n    for (let i = 0; i < listdata.length; i++) {\r\n      if (listdata[i].business_id == id) {\r\n        color = listdata[i].color;\r\n        break;\r\n      }\r\n    }\r\n    return color\r\n  }\r\n  /**\r\n   * 获取文字\r\n   * @param {*} id \r\n   * @returns \r\n   */\r\n  getItemText(id) {\r\n    let listdata = this.inittreeData.business_list;\r\n    let text = \"\";\r\n    for (let i = 0; i < listdata.length; i++) {\r\n      if (listdata[i].business_id == id) {\r\n        let languagelist = listdata[i].language;\r\n        for (let j = 0; j < languagelist.length; j++) {\r\n          if (languagelist[j].code == this.options.language_code) {\r\n            text = languagelist[j].name;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return text\r\n  }\r\n  drawItemText(text, x, y) {\r\n    //console.log(\"绘制drawItemText\",texts,x,y)\r\n    const texts = truncateNumber(text / 1000000, \"\");\r\n    \r\n    this.ctx.save(); // 保存当前绘图状态\r\n    this.ctx.translate(x, y); // 原点移动到移动到标签位置\r\n    // this.ctx.rotate(-Math.PI / 2); // 应用旋转变换\r\n    this.ctx.textAlign = 'left';\r\n    this.ctx.fontSize = \"10px\";\r\n    this.ctx.textBaseline = 'top'\r\n    this.ctx.fillText(texts, 0, 0); // 绘制旋转后的文字\r\n    this.ctx.restore(); // 恢复上下文状态\r\n    // this.ctx.textAlign = 'center';\r\n  }\r\n  // 绘制区域中的文字\r\n  drawText(text, x, y, width, height) {\r\n    var fontSize = 16;\r\n    this.ctx.font = fontSize + \"px Arial\";\r\n    this.ctx.fillStyle = 'black';\r\n    this.ctx.textAlign = 'center';\r\n    this.ctx.textBaseline = 'middle';\r\n\r\n    var textWidth = this.ctx.measureText(text).width;\r\n    // 文字显示方式\r\n    if (width >= textWidth) {\r\n      // 如果宽度足够，一行显示文字并居中\r\n      this.ctx.fillText(text, x + width / 2, y + height / 2);\r\n    } else if (height < fontSize) {\r\n      console.log(\"高度不足以显示文字\", height, fontSize)\r\n      // 如果高度不足以显示文字，文字不显示\r\n      return;\r\n    } else if (width >= fontSize * 2) {\r\n      // 如果宽度不足以显示一行文字但足够显示两行\r\n      var lineHeight = fontSize * 1.2;\r\n      var maxLines = Math.floor(height / lineHeight);\r\n      var lines = this.splitText(text, width, maxLines);\r\n\r\n      var totalHeight = lines.length * lineHeight;\r\n      var startY = y + height / 2 - totalHeight / 2 + lineHeight / 2;\r\n      for (let index = 0; index < lines.length; index++) {\r\n        const line = lines[index];\r\n        this.ctx.fillText(line, x + width / 2, startY + index * lineHeight);\r\n      }\r\n    } else {\r\n      // 如果宽度不足以显示两行文字，文字竖直显示\r\n      var maxHeight = height - 10; // 留点边距\r\n      var maxLines = Math.floor(maxHeight / fontSize);\r\n      if (maxLines == 0 || width < fontSize) {\r\n        return;\r\n      }\r\n      var lines = this.splitText(text, fontSize, maxLines);\r\n\r\n      var startY = y + height / 2 - lines.length * fontSize / 2;\r\n      for (let index = 0; index < lines.length; index++) {\r\n        const line = lines[index];\r\n        this.ctx.fillText(line, x + width / 2, startY + index * fontSize);\r\n      }\r\n    }\r\n  }\r\n\r\n  // 处理文本的拆分\r\n  splitText(text, maxWidth, maxLines) {\r\n    var lines = [];\r\n    var currentLine = '';\r\n    if(text==undefined||text==null||text==''){\r\n      return lines\r\n    }\r\n    for (var i = 0; i < text.length; i++) {\r\n      var testLine = currentLine + text[i];\r\n      var testWidth = this.ctx.measureText(testLine).width;\r\n\r\n      if (testWidth > maxWidth) {\r\n        if (currentLine.length > 0) {\r\n          lines.push(currentLine);\r\n        }\r\n        currentLine = text[i]; // Start new line with the current character\r\n      } else {\r\n        currentLine = testLine;\r\n      }\r\n\r\n      if (lines.length >= maxLines) {\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (currentLine.length > 0) {\r\n      lines.push(currentLine);\r\n    }\r\n    if (maxLines == 0) {\r\n      lines.splice(0);\r\n    }\r\n    // 如果行数超过最大行数，截断并添加省略号\r\n    if (lines.length > maxLines) {\r\n      lines[maxLines - 1] = lines[maxLines - 1].slice(0, -1) + '...';\r\n      // 删除多余的行\r\n      lines.splice(maxLines);\r\n    }\r\n\r\n    return lines;\r\n  }\r\n\r\n\r\n  // 绘制区域中的多行文字\r\n  drawTexts(texts, x, y, width, height){\r\n      // 生成最终行数组\r\n      var lineHeight=26;\r\n      var fontSize=16;\r\n      if(height<=14){\r\n        return false\r\n      }else if(height<=20){\r\n        lineHeight=18\r\n        fontSize=12\r\n      }else if(height<26){\r\n        lineHeight=20\r\n        fontSize=14\r\n      }\r\n      // width = width - 6; // 减去左右边距\r\n      // height = height - 6; // 减去上下边距\r\n      if(height<lineHeight||width<30||!texts instanceof Array){\r\n        return false\r\n      }\r\n      this.ctx.font = fontSize + \"px Arial\";\r\n      this.ctx.fillStyle = 'black';\r\n      this.ctx.textAlign = 'center';\r\n      this.ctx.textBaseline = 'middle';\r\n      const lines = [];\r\n      // 计算总高度  \r\n      let totalHeight = 0; \r\n      texts.forEach(paragraph => {\r\n      const words = paragraph.split('');\r\n      let currentLine = '';\r\n      let isFirstLine = false; // 是否是第一行\r\n\r\n      while (words.length > 0) {\r\n        // 添加缩进\r\n        if (isFirstLine) {\r\n          currentLine = '  '; // 两个空格占位\r\n          isFirstLine = false;\r\n        }\r\n\r\n        const nextWord = words.shift();\r\n        const testLine = currentLine + nextWord;\r\n        const testWidth =  this.ctx.measureText(testLine).width+6;\r\n\r\n        if (testWidth <= width&&width >32) {\r\n          currentLine = testLine;\r\n        } else {\r\n          lines.push(currentLine);\r\n          totalHeight += lineHeight;\r\n          currentLine = nextWord;\r\n          \r\n          // 高度检查\r\n          if (totalHeight + lineHeight > height) break;\r\n        }\r\n      }\r\n\r\n      if (currentLine) lines.push(currentLine);\r\n      totalHeight += lineHeight;\r\n    });\r\n    // 处理省略号\r\n    if (totalHeight > height) {\r\n      const maxLines = Math.floor(height / lineHeight);\r\n      lines.splice(maxLines); \r\n      //if (lines.length >= maxLines&&lines.length> 0) {\r\n      if (lines.length >= maxLines&&maxLines>0) {\r\n        // const lastLine = lines[maxLines - 1];\r\n        // const ellipsisWidth = this.ctx.measureText(\"...\").width;\r\n        \r\n        // let trimmedLine = lastLine;\r\n        // while (this.ctx.measureText(trimmedLine).width + ellipsisWidth > width) {\r\n        //   trimmedLine = trimmedLine.slice(0, -1);\r\n        // }\r\n        // lines[maxLines - 1] = trimmedLine + \"...\";\r\n        lines[maxLines - 1] = lines[maxLines - 1].slice(0, -1) + '...';\r\n      }\r\n    }\r\n    if (lines.length>0) {\r\n      // var fontSize = 16;\r\n      // this.ctx.font = fontSize + \"px Arial\";\r\n      // this.ctx.fillStyle = 'black';\r\n      // this.ctx.textAlign = 'center';\r\n      // this.ctx.textBaseline = 'middle';\r\n      // var startY = y + height / 2 - lines.length * fontSize / 2;\r\n      // for (let index = 0; index < lines.length; index++) {\r\n      //   const line = lines[index];\r\n      //   this.ctx.fillText(line, x + width / 2, startY + index * lineHeight);\r\n      // }\r\n      var startY = y + height / 2 - (lines.length-1) * lineHeight / 2;\r\n      var startX = x + (width+4) / 2;\r\n      lines.forEach((line, index) => {\r\n        this.ctx.fillText(line, startX, startY + index * lineHeight);\r\n      });\r\n    }\r\n  }\r\n  /**\r\n   * 加载数据\r\n   * @param {*} id 谱线id\r\n   * @param {*} data 谱线数据\r\n   */\r\n\r\n  onloadData(data) {\r\n    this.inittreeData = data;\r\n    this.drawChart(data);\r\n  }\r\n\r\n\r\n  //监听手指触摸操作\r\n  /**\r\n   * \r\n   * @param {*} e \r\n   */\r\n  touchstart(e) {\r\n    this.isDragging = false\r\n    if (e.touches.length == 1) {\r\n      this.isTouchDragging = true;\r\n      this.touchStartX = e.touches[0].clientX - this.offsetX;\r\n      this.touchStartY = e.touches[0].clientY;\r\n    } else if (e.touches.length == 2) {\r\n      this.isTouching = true;\r\n      var touch1 = e.touches[0];\r\n      var touch2 = e.touches[1];\r\n      //this.touchStartDist = Math.hypot(touch2.pageX - touch1.pageX, touch2.pageY - touch1.pageY);\r\n      this.touchStartInfo={\r\n        start_freq:this.options.x_axis.start_freq,//触摸显示开始频率\r\n        end_freq:this.options.x_axis.end_freq,//触摸显示结束频率\r\n        touch_center_freq:this.getTouchMouseVal(e).x\r\n      }\r\n      console.log(\"开始手指频率\",this.touchStartInfo)\r\n      this.showconsole(this.touchStartInfo)\r\n      this.touchStartDist = this.getDistance(touch1, touch2)\r\n      this.prevTouchDistance = this.touchStartDist;\r\n      this.lastTouchCenterX = (e.touches[0].clientX + e.touches[1].clientX) / 2; // 计算两手指中心点的X坐标\r\n    }\r\n  }\r\n  //监听手指触摸移动\r\n  /**\r\n   * 移动\r\n   * @param {*} e \r\n   */\r\n  touchmove(e) {\r\n    this.isDragging = true\r\n    if (e.touches.length == 1 && this.isTouchDragging) {\r\n      //console.log(\"移动\",e)\r\n      // 根据手指的移动方向来决定缩放方向\r\n      if (Math.abs(this.touchStartX - e.touches[0].clientX) > Math.abs(e.touches[0].clientY - this.touchStartY)) { // 主要是x轴方向的变化\r\n        this.scaleDirection = 'x'\r\n      } else { // 主要是y轴方向的变化\r\n        this.scaleDirection = 'y'\r\n      }\r\n      if (this.scaleDirection === 'x') {\r\n        let moveX = this.touchStartX - e.touches[0].clientX;\r\n        this.changeMovex(moveX, \"touchmove\")\r\n        this.touchStartX = e.touches[0].clientX\r\n      }\r\n      else if (this.scaleDirection === 'y') {\r\n        let offsety = e.touches[0].clientY - this.touchStartY;\r\n        this.changeMovey(offsety, \"touchmove\")\r\n        this.touchStartY = e.touches[0].clientY\r\n      }\r\n\r\n    } else if (this.isTouching && e.touches.length == 2) {\r\n      var touch1 = e.touches[0];\r\n      var touch2 = e.touches[1];\r\n      var touchDist = this.getDistance(touch1, touch2);\r\n      var angleNum = this.getAngle(touch1, touch2)\r\n      const dx = e.touches[0].pageX - e.touches[1].pageX;\r\n      const dy = e.touches[0].pageY - e.touches[1].pageY;\r\n\r\n      // 根据手指的移动方向来决定缩放方向\r\n      if (Math.abs(dx) > Math.abs(dy)) { // 主要是x轴方向的变化\r\n        this.scaleDirection = 'x'\r\n      } else { // 主要是y轴方向的变化\r\n        this.scaleDirection = 'y'\r\n      }\r\n      let scaleX = this.scaleX;\r\n      let scaleY = this.scaleY;\r\n      // 计算触摸移动的缩放因子\r\n      var scaleChange = touchDist / this.prevTouchDistance;\r\n      if (this.scaleDirection === 'x' || this.scaleDirection === 'both') {\r\n        scaleX *= scaleChange;\r\n        scaleX = scaleX.toFixed(1) - 0;\r\n        var freqdiff = this.options.x_axis.init_end_freq - this.options.x_axis.init_start_freq;\r\n        //var freqdiff = this.options.x_axis.end_freq - this.options.x_axis.start_freq;\r\n        if (freqdiff < this.chartWidth) {\r\n          return false\r\n        }\r\n        // 防止缩放过小或过大\r\n        if (scaleX < 1) scaleX = 1;\r\n        if (scaleX > 2000) scaleX = 2000;\r\n        // 更新触摸的上一距离\r\n        this.prevTouchDistance = touchDist;\r\n    \r\n        var mouseVal = this.touchStartInfo.touch_center_freq;\r\n        this.showconsole(\"放大中心触摸频率\"+mouseVal)\r\n        var newfreqStep = Math.floor(freqdiff / scaleX / 2) * 2;\r\n        var minValue = Math.floor(mouseVal-(mouseVal-this.touchStartInfo.start_freq)/(this.touchStartInfo.end_freq-this.touchStartInfo.start_freq)*newfreqStep);\r\n        var maxValue = Math.floor(minValue + newfreqStep)\r\n        if (minValue <= this.options.x_axis.init_start_freq && maxValue >= this.options.x_axis.init_end_freq) {\r\n          minValue = this.options.x_axis.init_start_freq;\r\n          maxValue = this.options.x_axis.init_end_freq;\r\n          scaleX = 1; // 重置缩放比例\r\n        }\r\n        if (minValue < this.options.x_axis.init_start_freq) {\r\n          console.log(\"处理超过最小值\", minValue)\r\n          minValue = this.options.x_axis.init_start_freq;\r\n          maxValue = Math.floor(minValue + newfreqStep)\r\n        }\r\n        if (maxValue > this.options.x_axis.init_end_freq) {\r\n          console.log(\"处理超过最大值\", maxValue)\r\n          maxValue = this.options.x_axis.init_end_freq;\r\n          minValue = Math.ceil(maxValue - newfreqStep);\r\n        }\r\n        if (minValue >= this.options.x_axis.init_start_freq && maxValue <= this.options.x_axis.init_end_freq) {\r\n\r\n          // if (this.onFreqChangeCallback) {\r\n          //   this.onFreqChangeCallback(minValue, maxValue)\r\n          // }\r\n\r\n          this.options.x_axis.start_freq = minValue;\r\n          this.options.x_axis.end_freq = maxValue;\r\n          this.scaleX = scaleX;\r\n          this.drawChart(); // 重新绘制地图\r\n          // this.showconsole({\r\n          //   type: \"手指缩放视图\",\r\n          //   \"start_freq\": this.options.x_axis.start_freq,\r\n          //   \"end_freq\": this.options.x_axis.end_freq,\r\n          //   \"scalex\": this.scaleX\r\n          // })\r\n          console.log(\"更改视图频率范围\", this.options.x_axis.start_freq, this.options.x_axis.end_freq, this.scaleX, this.scaleY)\r\n        }\r\n      }\r\n      if (this.scaleDirection === 'y' || this.scaleDirection === 'both') {\r\n        scaleY *= scaleChange;\r\n        scaleY = scaleY.toFixed(1) - 0\r\n        console.log(\"scaleY\", scaleY)\r\n        if (scaleY < 1) {\r\n          scaleY = 1\r\n          this.offsetY = 0\r\n        };\r\n        if (scaleY > 3) scaleY = 3;\r\n        this.scaleY = scaleY;\r\n        // this.updateScrollbar()\r\n        this.drawChart();\r\n      }\r\n\r\n\r\n\r\n\r\n\r\n    }\r\n\r\n  }\r\n  //监听手指触摸结束\r\n  /**\r\n   * 触摸结束\r\n   * @param {*} e\r\n   */\r\n  touchend(e) {\r\n    e.preventDefault();\r\n    console.log(\"触摸结束\", e)\r\n    if (this.isDragging && this.onFreqChangeCallback) {\r\n      if (this.callbackFreq.min !== this.options.x_axis.start_freq || this.callbackFreq.max !== this.options.x_axis.end_freq) {\r\n        console.log(\"触摸touchend结束回调\", this.options.x_axis.start_freq, this.options.x_axis.end_freq)\r\n        this.onFreqChangeCallback(this.options.x_axis.start_freq, this.options.x_axis.end_freq)\r\n        this.callbackFreq = {\r\n          min: this.options.x_axis.start_freq,\r\n          max: this.options.x_axis.end_freq\r\n        }\r\n      }\r\n    }\r\n    if (this.isDragging == false) {\r\n      console.log(\"手指点击结束\", e)\r\n      this.handleClick(e, \"touch\")\r\n    }\r\n    if (e.touches.length < 2) {\r\n      this.isTouchDragging = false;\r\n      this.isTouching = false;\r\n      this.prevTouchDistance = 0;\r\n    }\r\n\r\n  };\r\n  /**\r\n   * 计算两个触摸点之间的距离\r\n   * @param {*} touch1 \r\n   * @param {*} touch2 \r\n   * @returns \r\n   */\r\n  getDistance(touch1, touch2) {\r\n    // let dx = touch1.clientX - touch2.clientX;\r\n    // let dy = touch1.clientY - touch2.clientY;\r\n    const dx = touch2.pageX - touch1.pageX;\r\n    const dy = touch2.pageY - touch1.pageY;\r\n    return Math.sqrt(dx * dx + dy * dy);\r\n  }\r\n  /**\r\n   * 计算角度\r\n   * @param {*} touch1 \r\n   * @param {*} touch2 \r\n   * @returns \r\n   */\r\n  getAngle(touch1, touch2) {\r\n    const dx = touch2.pageX - touch1.pageX;\r\n    const dy = touch2.pageY - touch1.pageY;\r\n    const angleRad = Math.atan2(dy, dx); // 返回的是弧度\r\n    return angleRad * (180 / Math.PI); // 转换成度数\r\n  }\r\n  //监听事件\r\n  /**\r\n   * 鼠标按下事件\r\n   * @param {*} event \r\n   */\r\n  mousedown(event) {\r\n    console.log(\"点击了mousedown\")\r\n    this.mousedownInfo = {\r\n      isMouseDown: true,\r\n      startX: event.offsetX,\r\n      startY: event.offsetY,\r\n      mouseupx: 0,\r\n      mouseupy: 0,\r\n      button: event.button\r\n    }\r\n    if (event.button === 0) { // 左键\r\n      // isDragging = true;\r\n      // startY = event.clientY;\r\n      this.ctx.canvas.style.cursor = 'grabbing';\r\n    } else if (event.button === 2) { // 右键\r\n      this.ctx.canvas.style.cursor = 'grab';\r\n    }\r\n  }\r\n  /**\r\n   * 鼠标松开事件\r\n   * @param {*} event\r\n   */\r\n  mouseup(event) {\r\n    console.log(\"点击了mouseup\")\r\n    let mousedowinfo = {\r\n      isMouseDown: false,\r\n      mouseupx: event.offsetX,\r\n      mouseupy: event.offsetY,\r\n      button: event.button\r\n    }\r\n    this.mousedownInfo = {\r\n      ...this.mousedownInfo,\r\n      ...mousedowinfo\r\n    }\r\n    this.ctx.canvas.style.cursor = 'default';\r\n  }\r\n  /**\r\n   * 鼠标移动\r\n   * @param {*} event \r\n   */\r\n  mousemove(event) {\r\n    if (this.mousedownInfo.isMouseDown) {\r\n      if (this.moveInfo.preX == 0) {\r\n        this.moveInfo.preX = this.mousedownInfo.startX;\r\n        this.moveInfo.preY = this.mousedownInfo.startY;\r\n      }\r\n      const moveX = event.offsetX - this.moveInfo.preX;\r\n      const moveY = this.moveInfo.preY - event.offsetY;\r\n      const moveDirX = event.offsetX - this.mousedownInfo.startX;\r\n      const moveDirY = event.offsetY - this.mousedownInfo.startY;\r\n      let moveDir = \"horizontally\";\r\n      // 判断移动方向\r\n      if (Math.abs(moveDirX) > Math.abs(moveDirY)) {\r\n        moveDir = \"horizontally\";\r\n        this.changeMovex(moveX, \"mousemove\")\r\n      } else {\r\n        moveDir = \"vertically\";\r\n        this.changeMovey(moveY, \"mousemove\")\r\n      }\r\n\r\n    } else {\r\n      // 鼠标移动\r\n    }\r\n    this.moveInfo = {\r\n      isMove: true,\r\n      preX: event.offsetX,\r\n      preY: event.offsetY,\r\n      moveX: event.offsetX,\r\n      moveY: event.offsetY\r\n    }\r\n  }\r\n  /**\r\n   * 移动像素更改\r\n   * @param {*} movex \r\n   * @param {*} type \r\n   */\r\n  changeMovex(movex, type) {\r\n    movex = movex.toFixed(1) - 0\r\n    if (this.scaleX == 1) {\r\n      return false\r\n    }\r\n    let diffPx = this.freqPxStep * movex\r\n    let minValue = Math.floor(this.options.x_axis.start_freq + diffPx)\r\n    let maxValue = Math.floor(this.options.x_axis.end_freq + diffPx)\r\n    if (minValue <= this.options.x_axis.init_start_freq && maxValue >= this.options.x_axis.init_end_freq) {\r\n      minValue = this.options.x_axis.init_start_freq;\r\n      maxValue = this.options.x_axis.init_end_freq;\r\n      scaleX = 1; // 重置缩放比例\r\n    }\r\n    if (minValue < this.options.x_axis.init_start_freq) {\r\n      console.log(\"处理超过最小值\", minValue)\r\n      minValue = this.options.x_axis.init_start_freq;\r\n      maxValue = Math.floor(minValue + this.freqXDiff)\r\n    }\r\n    if (maxValue > this.options.x_axis.init_end_freq) {\r\n      console.log(\"处理超过最大值\", maxValue)\r\n      maxValue = this.options.x_axis.init_end_freq;\r\n      minValue = Math.ceil(maxValue - this.freqXDiff);\r\n    }\r\n    if (minValue >= this.options.x_axis.init_start_freq && maxValue <= this.options.x_axis.init_end_freq) {\r\n      // if (this.onFreqChangeCallback) {\r\n      //   this.onFreqChangeCallback(minValue, maxValue)\r\n      // }\r\n      this.options.x_axis.start_freq = minValue;\r\n      this.options.x_axis.end_freq = maxValue;\r\n      this.drawChart();\r\n\r\n      console.log(\"更改移动视图频率范围\", type, diffPx, this.options.x_axis.start_freq, this.options.x_axis.end_freq)\r\n    }\r\n  }\r\n  /**\r\n   * 改变y轴偏移\r\n   * @param {*} movey \r\n   * @param {*} type \r\n   */\r\n  changeMovey(movey, type) {\r\n    movey = movey.toFixed(1) - 0\r\n    if (this.scaleY == 1) {\r\n      this.offsetY = 0\r\n      // this.updateScrollbar()\r\n      this.drawChart();\r\n    } else {\r\n      let newoffsety = this.offsetY + movey;\r\n      let maxValue = 0;\r\n      let minValue = -this.chartHeight * (this.scaleY - 1)\r\n      if (newoffsety <= maxValue && newoffsety >= minValue) {\r\n        this.offsetY = newoffsety\r\n        console.log(\"更改移动y\", type, this.offsetY, \"y层级\", this.scaleY, this.chartHeight, this.chartHeight * (this.scaleY - 1))\r\n        // this.updateScrollbar()\r\n        this.drawChart();\r\n      } else if (newoffsety > maxValue) {\r\n        this.offsetY = maxValue\r\n      } else if (newoffsety < minValue) {\r\n        this.offsetY = minValue\r\n      } else {\r\n        this.offsetY = 0\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * 鼠标移出控件\r\n   * @param {*} event \r\n   */\r\n  mouseout(event) {\r\n    event.preventDefault();\r\n    this.mousedownInfo.isMouseDown = false\r\n    this.moveInfo = {\r\n      isMove: false,\r\n      preX: 0,\r\n      preY: 0,\r\n      moveX: 0,\r\n      moveY: 0\r\n    }\r\n  }\r\n  /**\r\n   * 鼠标滚轮事件\r\n   * @param {*} event\r\n   * \r\n   */\r\n  handleWheel(event) {\r\n    event.preventDefault(); // 阻止默认滚动行为\r\n    const delta = event.deltaY < 0 ? 1 : -1; //下滚缩小，上滚放大\r\n    //const delta = Math.sign(event.deltaY);\r\n    this.handleZoom(event, delta);\r\n  }\r\n  /**\r\n   * 双击事件\r\n   * @param {*} event \r\n   */\r\n  handleDblClick(event) {\r\n    console.log(\"handleDblClick\", event);\r\n  }\r\n  /**\r\n   * 点击事件\r\n   * @param {*} event \r\n   */\r\n  handleClick(event, type) {\r\n    console.log(\"handleClick\" + type, event);\r\n    if (type == \"touch\") {\r\n      event = event.changedTouches[0]\r\n    }\r\n    const rect = this.canvas.getBoundingClientRect(); // 获取 Canvas 的位置和大小\r\n    let mouseX = event.clientX - rect.left; // 计算鼠标相对于 Canvas 的 X 坐标\r\n    let mouseY = event.clientY - rect.top; // 计算鼠标相对于 Canvas 的 Y 坐标\r\n    var clickedArea = this.checkClick(this.treeData, mouseX, mouseY);\r\n    console.log(\"点击区域\", clickedArea, mouseX, mouseY)\r\n    if (clickedArea) {\r\n      this.selectedArea = clickedArea.area;\r\n      let focusList = this.getFocusList(clickedArea.area);\r\n      console.log(\"表格焦点获取\", clickedArea, focusList)\r\n\r\n      this.changeFocus(focusList.column, focusList.row, \"grid\")\r\n\r\n      //回调消息\r\n      if (this.onClickGridCallback) {\r\n        if (clickedArea.childArea) {\r\n          this.onClickGridCallback(clickedArea.childArea.area)\r\n        } else {\r\n          this.onClickGridCallback(clickedArea.area)\r\n        }\r\n\r\n        this.focusInfo.prefocus = this.focusInfo.focus;\r\n        //this.focusInfo.focus = null;\r\n        if (this.onFocusCallback) {\r\n          this.onFocusCallback(\"\")\r\n        }\r\n      }\r\n      this.drawChart(); // 重新绘制地图并高亮选中区域\r\n    } else {\r\n      this.selectedArea = null;\r\n      this.drawChart(); // 重新绘制地图并去掉高亮\r\n    }\r\n  }\r\n  /**\r\n   * 获取网格数据\r\n   */\r\n  getGridInfo(treedata, orderid) {\r\n    let returnData = null\r\n    for (let i = 0; i < treedata.length; i++) {\r\n      let areas = []\r\n      if (this.options.type !== 1) {\r\n        areas = treedata[i]\r\n      } else {\r\n        areas = treedata[i].business;\r\n      }\r\n      for (var index = 0; index < areas.length; index++) {\r\n        var area = areas[index]\r\n        if (area.orderid == orderid) {\r\n          returnData = area\r\n          break\r\n        }\r\n      }\r\n    }\r\n    return returnData\r\n  }\r\n  /**\r\n   * 获取焦点项\r\n   * @param {*} orderid \r\n   * @returns \r\n   */\r\n  getFocusList(clickedArea) {\r\n    let orderid = clickedArea.orderid\r\n    let returnData = null\r\n    let treedata = this.focusInfo.list;\r\n    for (let i = 0; i < treedata.length; i++) {\r\n      let areas = treedata[i]\r\n      for (var index = 0; index < areas.length; index++) {\r\n        var area = areas[index]\r\n        if (area.key == orderid) {\r\n          returnData = area\r\n          break\r\n        }\r\n      }\r\n    }\r\n    return returnData\r\n  }\r\n  /**\r\n   * 检查点击是否在区域内\r\n   * @param {*} x 坐标\r\n   * @param {*} y 坐标\r\n   * @returns \r\n   */\r\n\r\n  checkClick(treedata, x, y) {\r\n    for (let i = 0; i < treedata.length; i++) {\r\n      let areas = []\r\n      if (this.options.type !== 1) {\r\n        areas = treedata[i]\r\n      } else {\r\n        areas = treedata[i].business;\r\n      }\r\n      for (var index = 0; index < areas.length; index++) {\r\n        var area = areas[index]\r\n        var areaX = area.x;\r\n        var areaY = area.y;\r\n        var areaWidth = area.width;\r\n        var areaHeight = area.height;\r\n        if (x >= areaX && x <= areaX + areaWidth && y >= areaY && y <= areaY + areaHeight) {\r\n          console.log(\"点击区域\", treedata[i].business, area)\r\n          var childArea = null\r\n          if (area.child_business_list && area.child_business_list.length > 0) {\r\n            childArea = this.checkClick(area.child_business_list, x, y)\r\n            console.log(\"子区域点击区域\", childArea)\r\n          }\r\n          if (childArea) {\r\n            return {\r\n              childArea: childArea,\r\n              area: area\r\n            }\r\n          } else {\r\n            return {\r\n              area: area\r\n            }\r\n          }\r\n        };\r\n      }\r\n    }\r\n  }\r\n  /*\r\n   * 鼠标右键事件\r\n   * @param {*} event\r\n   */\r\n  handleContextMenu(event) {\r\n    console.log(\"handleContextMenu\", event);\r\n  }\r\n  /**\r\n   * 按键按下事件\r\n   * @param {*} event\r\n   */\r\n  handleKeydown(event) {\r\n    //console.log(\"handleKeydown\", event);\r\n    // switch (event.keyCode) {\r\n    //   case 37: // 左箭头\r\n    //     console.log(\"左箭头\");\r\n    //     break;\r\n    //   case 38: // 上箭头\r\n    //     console.log(\"上箭头\");\r\n    //     this.changeThreshold(+0.5)\r\n    //     break;\r\n    //   case 39: // 右箭头\r\n    //     console.log(\"右箭头\");\r\n    //     break;\r\n    //   case 40: // 下箭头\r\n    //     this.changeThreshold(-0.5)\r\n    //   default:\r\n    //     break;\r\n    // }\r\n    if (event.key === 'x') {\r\n      this.scaleDirection = 'x'; // 只缩放X轴\r\n    } else if (event.key === 'y') {\r\n      this.scaleDirection = 'y'; // 只缩放Y轴\r\n    } else if (event.key === 'b') {\r\n      this.scaleDirection = 'both'; // 同时缩放X轴和Y轴\r\n    }\r\n  }\r\n  /**\r\n   * 按键松开事件\r\n   * @param {*} event \r\n   */\r\n  handleKeyup(event) {\r\n    console.log(\"handleKeyup按键松开事件\", event);\r\n    switch (event.keyCode) {\r\n      case 37: // 左箭头\r\n        console.log(\"左箭头松开\");\r\n        break;\r\n      case 38: // 上箭头\r\n        console.log(\"上箭头松开\");\r\n        this.options.threshold.is_mouse = false;\r\n        break;\r\n      case 39: // 右箭头\r\n        console.log(\"右箭头松开\");\r\n        break;\r\n      case 40: // 下箭头\r\n        console.log(\"下箭头松开\");\r\n        this.options.threshold.is_mouse = false;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n  /**\r\n   * 滚动条改变事件\r\n   * @param {*} event \r\n   * @returns \r\n   */\r\n  handleScroll(event) {\r\n    event.preventDefault(); // 阻止默认滚动行为\r\n    //console.log('当前距顶部距离:', this.scrollBar.scrollTop);\r\n  }\r\n  /**\r\n   * 滚动条手指移动事件\r\n   * @param {*} offsety \r\n   */\r\n  mousedownScroll(event) {\r\n    event.preventDefault(); \r\n    this.scrollBarInfo.isMove = true;\r\n  }\r\n  mouseupScroll(event) {\r\n    event.preventDefault(); \r\n    this.scrollBarInfo.isMove = false;\r\n  }\r\n  mousemoveScroll(event){\r\n    event.preventDefault(); // 阻止默认滚动行为\r\n    console.log('mousemoveScroll顶部距离:', this.scrollBar.scrollTop,this.scrollBarInfo.isMove);\r\n    if(this.offsetY != -this.scrollBar.scrollTop){\r\n      this.setOffsetY(-this.scrollBar.scrollTop)\r\n    }\r\n  }\r\n  setOffsetY(offsety) {\r\n    this.offsetY = offsety;\r\n    this.drawChart(); // 重新绘制图表\r\n  }\r\n  /**\r\n   * 更新滚动条\r\n   * @returns\r\n   */\r\n  updateScrollbar() {\r\n    // 计算滚动条的位置和大小\r\n    var isshow=false\r\n    if(this.options.scrollbar_show==\"show\"){\r\n      this.scrollBar.style.display = \"block\";\r\n      isshow=true\r\n    }else if(this.options.scrollbar_show==\"hide\"){\r\n      this.scrollBar.style.display = \"none\"; \r\n    }else{\r\n      if(this.scaleY>1){\r\n        this.scrollBar.style.display = \"block\"; \r\n        isshow=true\r\n      }else{\r\n        this.scrollBar.style.display = \"none\"; \r\n      }\r\n    }\r\n    if(isshow){\r\n      this.scrollBarContent.style.height = this.chartHeight*this.scaleY + \"px\";\r\n      const scrollBarHeight = this.scrollBarContent.offsetHeight;\r\n      this.scrollBar.scrollTop = -this.offsetY;\r\n      console.log(\"滚动条位置\", this.scrollBar.scrollTop, this.offsetY, scrollBarHeight)\r\n    }\r\n  }\r\n  /**\r\n   * 窗口大小改变事件\r\n   */\r\n  resizeCanvas() {\r\n    this.setCanvasSize(); // 重新设置 Canvas 尺寸\r\n    this.drawChart(); // 重新绘制图表以适应新尺寸\r\n  }\r\n  /**\r\n   * 设置图表大小\r\n   * @param {*} widhts 宽度\r\n   *  @param {*} heights 高度\r\n   */\r\n  setChartSize(widths, heights) {\r\n    if (widths && heights) {\r\n      this.options.width = widths\r\n      this.options.height = heights\r\n    }\r\n    this.setCanvasSize(widths, heights)\r\n    this.drawChart(); // 重新绘制图表以适应新尺寸\r\n  }\r\n  //按钮点击设置缩放\r\n  setZomm(type, event) {\r\n    event.stopPropagation(); // 阻止事件冒泡\r\n    console.log(\"点击缩放set\",this.focusInfo.list)\r\n    this.focusInfo.focus = this.focusInfo.list[0][0]\r\n    this.drawChart(); // 重新绘制图表\r\n\r\n    if (this.onClickZommCallback) {\r\n      this.onClickZommCallback(type)\r\n    }\r\n  }\r\n  //[切换]按钮点击设置\r\n  setSwitch(event) {\r\n    event.stopPropagation(); // 阻止事件冒泡\r\n    var order=this.focusInfo.list[0].length-1;\r\n    this.focusInfo.focus = this.focusInfo.list[0][order]\r\n    this.focusInfo.prefocus = this.focusInfo.list[0][order];\r\n    //this.focusInfo.focus = null;\r\n    this.drawChart(); // 重新绘制图表\r\n    if (this.onSwitchCallback) {\r\n      this.onSwitchCallback()\r\n      if (this.onFocusCallback) {\r\n        this.onFocusCallback(\"\")\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * 缩放事件\r\n   * @param {*} event \r\n   * @param {*} types \r\n   * @param {*} delta \r\n   * @returns \r\n   */\r\n  handleZoom(event, delta) {\r\n    event.preventDefault(); // 阻止默认滚动行为\r\n    let type = this.getMousePosition()\r\n    let zoomFactor = 1.1; // 缩放因子\r\n    if (event.deltaY < 0) {\r\n      zoomFactor = 1.1\r\n    } else {\r\n      zoomFactor = 0.9\r\n    }\r\n    let scaleX = this.scaleX;\r\n    let scaleY = this.scaleY;\r\n    if (this.scaleDirection === 'x' && type == \"grid\" || this.scaleDirection === 'both' && type == \"grid\") {\r\n      scaleX *= zoomFactor; // 调整X轴的缩放比例\r\n      scaleX = scaleX.toFixed(1) - 0\r\n      var freqdiff = this.options.x_axis.init_end_freq - this.options.x_axis.init_start_freq;\r\n      if (freqdiff < this.chartWidth) {\r\n        return false\r\n      }\r\n      // 防止缩放过小或过大\r\n      if (scaleX < 0.5) scaleX = 0.5;\r\n      if (scaleX > 2000) scaleX = 2000;\r\n      var mouseVal = this.getMouseVal(event, 0).x;\r\n\r\n      var newfreqStep = Math.floor(freqdiff / scaleX / 2) * 2;\r\n      console.log(\"层级变化\", newfreqStep, scaleX)\r\n      var minValue = Math.floor(mouseVal - (mouseVal - this.options.x_axis.start_freq)/(this.options.x_axis.end_freq-this.options.x_axis.start_freq)*newfreqStep);\r\n      var maxValue = Math.floor(minValue + newfreqStep)\r\n      if (minValue <= this.options.x_axis.init_start_freq && maxValue >= this.options.x_axis.init_end_freq) {\r\n        minValue = this.options.x_axis.init_start_freq;\r\n        maxValue = this.options.x_axis.init_end_freq;\r\n        scaleX = 1; // 重置缩放比例\r\n      }\r\n      if (minValue < this.options.x_axis.init_start_freq) {\r\n        console.log(\"处理超过最小值\", minValue)\r\n        minValue = this.options.x_axis.init_start_freq;\r\n        maxValue = Math.floor(minValue + newfreqStep)\r\n      }\r\n      if (maxValue > this.options.x_axis.init_end_freq) {\r\n        console.log(\"处理超过最大值\", maxValue)\r\n        maxValue = this.options.x_axis.init_end_freq;\r\n        minValue = Math.ceil(maxValue - newfreqStep);\r\n      }\r\n      if (minValue >= this.options.x_axis.init_start_freq && maxValue <= this.options.x_axis.init_end_freq) {\r\n\r\n        this.options.x_axis.start_freq = minValue;\r\n        this.options.x_axis.end_freq = maxValue;\r\n        this.scaleX = scaleX;\r\n        if (this.onFreqChangeCallback) {\r\n          //this.scaleX = scaleX;\r\n          console.log(\"鼠标缩放频率范围\", minValue, maxValue)\r\n          this.onFreqChangeCallback(minValue, maxValue)\r\n        }\r\n        console.log(\"更改视图频率范围\", this.options.x_axis.start_freq, this.options.x_axis.end_freq)\r\n        this.drawChart();\r\n      }\r\n    }\r\n\r\n\r\n    if (this.scaleDirection === 'y' && type == \"grid\" || this.scaleDirection === 'both' && type == \"grid\") {\r\n      scaleY *= zoomFactor; // 调整Y轴的缩放比例\r\n      scaleY = scaleY.toFixed(1) - 0\r\n\r\n      if (scaleY < 1) {\r\n        scaleY = 1\r\n        this.offsetY = 0\r\n      };\r\n      if (scaleY > 3) scaleY = 3;\r\n      this.scaleY = scaleY;\r\n      this.drawChart();\r\n      // this.updateScrollbar(); // 更新滚动条位置\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  }\r\n  /**\r\n   * 获取鼠标位置对应的值\r\n   * @param {*} event \r\n   * @returns \r\n   */\r\n  getMouseVal(event) {\r\n    // let pointx = event.offsetX;\r\n    // let pointy = event.offsetY;\r\n    const rect = this.canvas.getBoundingClientRect(); // 获取 Canvas 的位置和大小\r\n    let pointx = event.clientX - rect.left; // 计算鼠标相对于 Canvas 的 X 坐标\r\n    let pointy = event.clientY - rect.top; // 计算鼠标相对于 Canvas 的 Y 坐标\r\n    let x = null; //x轴频率\r\n    let y = null; //y轴频率\r\n    let order = null; //x轴标签组序号\r\n    var freqdiff = this.options.x_axis.end_freq - this.options.x_axis.start_freq;\r\n\r\n\r\n    if (pointx < this.options.grid.left) {\r\n      x = this.options.x_axis.start_freq;\r\n      order = 0\r\n    } else if (pointx >= this.options.grid.left && pointx <= this.width - this.options.grid.left) {\r\n      x = this.options.x_axis.start_freq + (pointx - this.options.grid.left) / this.chartWidth * freqdiff\r\n      x = Math.floor(x)\r\n      console.log(\"点频率值\", x)\r\n    }\r\n    return {\r\n      x,\r\n      y,\r\n      order\r\n    };\r\n  }\r\n  /**\r\n   * 计算手指中心点值\r\n   * @param {*} event \r\n   */\r\n  getTouchMouseVal(e) {\r\n    const rect = this.canvas.getBoundingClientRect(); // 获取 Canvas 的位置和大小\r\n    let centerX = (e.touches[0].clientX + e.touches[1].clientX) / 2; // 计算两手指中心点的X坐标\r\n    let centerY = (e.touches[0].clientY + e.touches[1].clientY) / 2; // 计算两手指中心点的X坐标\r\n\r\n    let pointx = centerX - rect.left; // 计算鼠标相对于 Canvas 的 X 坐标\r\n    let pointy = centerY - rect.top; // 计算鼠标相对于 Canvas 的 Y 坐标\r\n    let x = null; //x轴频率\r\n    let y = null; //y轴频率\r\n    let order = null; //x轴标签组序号\r\n    var freqdiff = this.options.x_axis.end_freq - this.options.x_axis.start_freq;\r\n    if (pointx < this.options.grid.left) {\r\n      x = this.options.x_axis.start_freq;\r\n      // this.showconsole({\r\n      //   point: pointx,\r\n      //   \"type\": \"小于左边界\" + this.options.grid.left\r\n      // })\r\n      order = 0\r\n    } else if (pointx >= this.options.grid.left && pointx <= this.width - this.options.grid.left) {\r\n      x = this.options.x_axis.start_freq + (pointx - this.options.grid.left) / this.chartWidth * freqdiff\r\n      x = Math.floor(x)\r\n      console.log(\"点频率值\", x)\r\n      // this.showconsole({\r\n      //   point: pointx,\r\n      //   \"type\": \"获取手指中心频率\",\r\n      //   \"freq\": x\r\n      // })\r\n    }\r\n    return {\r\n      x,\r\n      y,\r\n      order\r\n    };\r\n  }\r\n  /**\r\n   * 获取当前鼠标所在位置频率和强度\r\n   * @param {*} event \r\n   */\r\n  getMousePoint(event) {\r\n    const rect = this.canvas.getBoundingClientRect(); // 获取 Canvas 的位置和大小\r\n    let pointx = event.clientX - rect.left; // 计算鼠标相对于 Canvas 的 X 坐标\r\n    let pointy = event.clientY - rect.top; // 计算鼠标相对于 Canvas 的 Y 坐标\r\n    return {\r\n      pointx,\r\n      pointy\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 获取鼠标当前区域\r\n   * @param {*} event \r\n   * @returns \r\n   */\r\n  getMousePosition(events) {\r\n    var event = window.event;\r\n    const rect = this.canvas.getBoundingClientRect(); // 获取 Canvas 的位置和大小\r\n    const x = event.clientX - rect.left; // 计算鼠标相对于 Canvas 的 X 坐标\r\n    const y = event.clientY - rect.top; // 计算鼠标相对于 Canvas 的 Y 坐标\r\n    var result = \"\"\r\n    // 检查鼠标是否在 Canvas 内部\r\n    if (x < 0 || x > this.width || y < 0 || y > this.height) {\r\n      result = null;\r\n    } else if (x < this.options.grid.left) {\r\n      result = \"left\";\r\n    } else if (y < this.options.grid.top) {\r\n      result = \"top\";\r\n    } else if (x > this.canvas.width - this.options.grid.right) {\r\n      result = \"right\";\r\n    } else if (y > this.canvas.height - this.options.grid.bottom) {\r\n      result = \"bottom\";\r\n    } else {\r\n      result = \"grid\";\r\n    }\r\n    this.focusType = result;\r\n    return result;\r\n  }\r\n  /**\r\n   * 获取频率范围内的业务名称\r\n   * @param {*} start \r\n   * @param {*} end \r\n   * @returns \r\n   */\r\n  getFreqBussiness(datas) {\r\n    let rangeData=this.getRegionData(this.inittreeData.band_list, datas.start, datas.end)\r\n    let names=[];\r\n    for (let i = 0; i < rangeData.length; i++) {\r\n      if (rangeData[i].business_id) {\r\n        names.push(this.getItemText(rangeData[i].business_id))\r\n      }else if(this.options.type==1&&rangeData[i].business&&rangeData[i].business.length>0){\r\n        for (let j = 0; j < rangeData[i].business.length; j++) {\r\n          names.push(this.getItemText(rangeData[i].business[j].business_id))\r\n        }\r\n      }\r\n    }\r\n    console.log(\"获取频率范围内的业务名称\", rangeData)\r\n    return this.uniqueChinese(names)\r\n  }\r\n  uniqueChinese(arr) {\r\n    var hashMap = Object.create(null); // 创建空对象，无原型链更高效\r\n    var result = [];\r\n    for (var i = 0; i < arr.length; i++) {\r\n      var item = arr[i];\r\n      if (!hashMap[item]) {          // 哈希表直接查询\r\n        hashMap[item] = true;        // 标记存在状态\r\n        result.push(item);\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n  /**\r\n   * 获取配置\r\n   */\r\n  getOptions() {\r\n    return this.options;\r\n  }\r\n  /**\r\n   * 设置频率回调\r\n   * @param {*} callback \r\n   */\r\n  onFreq(callback) {\r\n    this.onFreqChangeCallback = callback;\r\n  }\r\n  /*\r\n   * 设置点击回调\r\n   * @param {*} callback\r\n   */\r\n  onClick(callback) {\r\n    this.onClickGridCallback = callback;\r\n  }\r\n  /**\r\n   * 设置按键回调\r\n   * @param {*} callback \r\n   */\r\n  onKey(callback) {\r\n    this.onKeyCallback = callback;\r\n  }\r\n  /**\r\n   * 设置缩放回调\r\n   */\r\n  onClickZoom(callback) {\r\n    this.onClickZommCallback = callback;\r\n  }\r\n  /**\r\n   * 设置焦点回调\r\n   */\r\n  onFocus(callback) {\r\n    this.onFocusCallback = callback\r\n  }\r\n  /**\r\n   * 设置切换回调\r\n   */\r\n  onSwitch(callback) {\r\n    this.onSwitchCallback = callback\r\n  }\r\n  /**\r\n   * 更新配置项\r\n   * @param {*} options\r\n   *  \r\n   */\r\n  updateOptions(options) {\r\n    let newoptions = deepMerge(this.options, options);\r\n    this.initOptions(newoptions,\"update\");\r\n    this.drawChart();\r\n  }\r\n  /**\r\n   * 设置树数据\r\n   * @param {*} datas\r\n   */\r\n  setChartData(datas) {\r\n    this.initDefault();\r\n    this.readJsonData(datas);\r\n    this.drawChart();\r\n  }\r\n  /**\r\n   * 设置初始频率范围\r\n   * @param {*} datas \r\n   */\r\n  setInitFreqRange(datas) {\r\n    if (datas.start && datas.end) {\r\n      this.initDefault();\r\n      this.options.x_axis.init_start_freq = datas.start;\r\n      this.options.x_axis.init_end_freq = datas.end;\r\n      this.options.x_axis.start_freq = datas.start;\r\n      this.options.x_axis.end_freq = datas.end;\r\n      this.drawChart()\r\n    } else {\r\n      console.log(\"请输入正确的初始频率范围\")\r\n    }\r\n  }\r\n  /**\r\n   * 对外方法\r\n   * 设置频率范围\r\n   */\r\n  setfreqRange(datas) {\r\n    if (datas.start && datas.end) {\r\n      let start_freq = datas.start;\r\n      let end_freq = datas.end;\r\n      if (start_freq == this.options.x_axis.init_start_freq && end_freq == this.options.x_axis.init_end_freq) {\r\n        //初始绘制频率\r\n        this.initDefault();\r\n      }\r\n      this.options.x_axis.start_freq = start_freq;\r\n      this.options.x_axis.end_freq = end_freq;\r\n      this.drawChart()\r\n    } else {\r\n      console.log(\"请输入正确的频率范围\")\r\n    }\r\n  }\r\n  setLoadMask(datas) {\r\n    if (datas) {\r\n      this.loadMask.style.display = \"flex\";\r\n      this.loadMask.innerText =\"...\";\r\n    } else {\r\n      this.loadMask.style.display = \"none\";\r\n    }\r\n  }\r\n  /**\r\n   * 设置锁屏\r\n   * @param {*} datas \r\n   */\r\n  setLock(datas) {\r\n    if (datas) {\r\n      this.lockBox.style.display = \"flex\";\r\n      this.lockBox.style.backgroundColor = colorTostring(this.options.lock.background)\r\n      this.lockBox.style.fontSize = this.options.lock.font_size + \"px\";\r\n      this.lockBox.style.color = colorTostring(this.options.lock.color)\r\n      this.lockBox.innerText = this.options.lock.content;\r\n\r\n    } else {\r\n      this.lockBox.style.display = \"none\";\r\n    }\r\n\r\n  }\r\n\r\n  setKey(datas) {\r\n    let type = datas.type;\r\n    let action = datas.action;\r\n    if (this.focusInfo.focus == null) {\r\n      if (type == 4) {\r\n        if (this.onFocusCallback) {\r\n          this.onFocusCallback(\"chart\")\r\n        }\r\n        if (this.focusInfo.prefocus && this.focusInfo.prefocus.type == \"grid\" || this.focusInfo.prefocus && this.focusInfo.prefocus.key == \"switch\") {\r\n          this.focusInfo.focus = this.focusInfo.prefocus\r\n        } else {\r\n          //焦点图表\r\n          this.focusInfo.focus = {\r\n            \"type\": \"chart\",\r\n            \"key\": -1,\r\n            \"column\": -1,\r\n            \"row\": -1\r\n          }\r\n        }\r\n\r\n      }\r\n    } else if (type == 0) {\r\n      //上\r\n      if (this.focusInfo.focus.type !== \"chart\") {\r\n        let x = this.focusInfo.focus.column;\r\n        let y = this.focusInfo.focus.row - 1;\r\n        if (y < 0) {\r\n          x = x - 1;\r\n          if (x < 0) {\r\n            x = this.focusInfo.list.length - 1;\r\n          }\r\n          y = this.focusInfo.list[x].length - 1;\r\n        }\r\n        this.changeFocus(x, y, type)\r\n      }\r\n    } else if (type == 1) {\r\n      //下\r\n      if (this.focusInfo.focus.type !== \"chart\") {\r\n        let x = this.focusInfo.focus.column;\r\n        let y = this.focusInfo.focus.row + 1\r\n        let maxValue = this.focusInfo.list[x].length - 1;\r\n        if (y > maxValue) {\r\n          x = x + 1;\r\n          if (x > this.focusInfo.list.length - 1) {\r\n            x = 0;\r\n          }\r\n          y = 0;\r\n        }\r\n        this.changeFocus(x, y, type)\r\n      }\r\n    } else if (type == 2) {\r\n      //左\r\n      if (this.focusInfo.focus.type !== \"chart\") {\r\n        let x = this.focusInfo.focus.column - 1;\r\n        let y = this.focusInfo.focus.row;\r\n        let maxValue = this.focusInfo.list.length - 1;\r\n        if (x < 0) {\r\n          x = maxValue\r\n        }\r\n        let currentRows = this.focusInfo.list[x].length - 1;\r\n        if (y > currentRows) {\r\n          y = currentRows\r\n        }\r\n        this.changeFocus(x, y, type)\r\n      }\r\n    } else if (type == 3) {\r\n      //右\r\n      if (this.focusInfo.focus.type !== \"chart\") {\r\n        let x = this.focusInfo.focus.column + 1;\r\n        let y = this.focusInfo.focus.row;\r\n        let maxValue = this.focusInfo.list.length - 1;\r\n        if (x > maxValue) {\r\n          x = 0\r\n        }\r\n        let currentRows = this.focusInfo.list[x].length - 1;\r\n        if (y > currentRows) {\r\n          y = currentRows\r\n        }\r\n        this.changeFocus(x, y, type)\r\n      }\r\n    } else if (type == 4) {\r\n      //确定\r\n      console.log(\"确定4\",this.focusInfo.focus)\r\n      if (this.focusInfo.focus.type == \"chart\") {\r\n        this.changeFocus(0, 0, type)\r\n      } else if (this.focusInfo.focus.type == \"button\") {\r\n        if (this.focusInfo.focus.key == \"zoomin\") {\r\n          document.getElementById(\"zoom_in\").click();\r\n        }else if(this.focusInfo.focus.key==\"switch\"){\r\n          document.getElementById(\"switch_button\").click();\r\n        }\r\n\r\n      } else if (this.focusInfo.focus.type == \"grid\") {\r\n        let orderid = this.focusInfo.focus.key;\r\n        let gridInfo = this.getGridInfo(this.treeData, orderid);\r\n        this.selectedArea = gridInfo\r\n        console.log(\"gridInfo\", gridInfo)\r\n        //回调消息\r\n        if (this.onClickGridCallback) {\r\n          this.onClickGridCallback(gridInfo)\r\n          this.focusInfo.prefocus = this.focusInfo.focus;\r\n          //this.focusInfo.focus = null;\r\n          if (this.onFocusCallback) {\r\n            this.onFocusCallback(\"\")\r\n          }\r\n\r\n        }\r\n      }\r\n    } else if (type == 5) {\r\n      //返回\r\n      if (this.focusInfo.focus.type == \"chart\") {\r\n        this.focusInfo.prefocus = null;\r\n        this.focusInfo.focus = null\r\n        if (this.onFocusCallback) {\r\n          this.onFocusCallback(\"\")\r\n        }\r\n      } else {\r\n        //返回到图表焦点\r\n\r\n        this.focusInfo.prefocus = null;\r\n        this.focusInfo.focus = {\r\n          \"type\": \"chart\",\r\n          \"key\": -1,\r\n          \"column\": -1,\r\n          \"row\": -1\r\n        }\r\n      }\r\n    } else if (type == 6) {\r\n      //清除\r\n      this.focusInfo.prefocus = this.focusInfo.focus;\r\n      this.focusInfo.focus = null\r\n      if (this.onFocusCallback) {\r\n        this.onFocusCallback(\"\")\r\n      }\r\n    }\r\n    this.drawChart();\r\n  }\r\n\r\n  setZoom(datas) {\r\n    if (datas == 2) {\r\n      this.zoomStatus = 2;\r\n      this.zoomBox.style.backgroundImage = 'url(\"img/down.png\")';\r\n    } else {\r\n      this.zoomStatus = 1;\r\n      this.zoomBox.style.backgroundImage = 'url(\"img/up.png\")';\r\n    }\r\n  }\r\n  changeFocus(x, y, type) {\r\n    console.log(\"切换焦点\",x, y, type,this.focusInfo.list)\r\n    if(this.focusInfo.focus){\r\n      this.focusInfo.prefocus = this.focusInfo.focus;\r\n    }\r\n    if (type == \"grid\") {\r\n\r\n    }\r\n    let columns=this.focusInfo.list[x]\r\n    for (let index = 0; index < columns.length; index++) {\r\n      var items = columns[index];\r\n      if(items.row==y){\r\n        this.focusInfo.focus = items\r\n        break;\r\n      }\r\n    }\r\n    \r\n    console.log(\"赋值焦点\",this.focusInfo.focus)\r\n  }\r\n  /**\r\n   * 焦点勾选\r\n   * @returns \r\n   */\r\n  selcetedFocus() {\r\n    this.clearElmentFocus();\r\n    if (this.focusInfo.focus == null) {\r\n      return false\r\n    }\r\n    if (this.focusInfo.focus.type == \"chart\" || this.focusInfo.focus.type == \"button\") {\r\n      if (this.focusInfo.focus.type == \"chart\") {\r\n        document.getElementById(\"mycanvas\").classList.add(\"active\");\r\n      } else {\r\n        if (this.focusInfo.focus.key == \"zoomin\") {\r\n          document.getElementById(\"zoom_in\").classList.add(\"active\");\r\n        } else if (this.focusInfo.focus.key == \"switch\") {\r\n          document.getElementById(\"switch_button\").classList.add(\"active\");\r\n        }\r\n      }\r\n\r\n    } else if (this.focusInfo.focus.type == \"grid\") {\r\n      console.log(\"点击绘制\", this.focusInfo.focus)\r\n    }\r\n  }\r\n  /**\r\n   * 清除焦点active\r\n   * @returns \r\n   */\r\n  clearElmentFocus() {\r\n    let eleactives = document.querySelectorAll('.active')\r\n    for (let i = 0; i < eleactives.length; i++) {\r\n      eleactives[i].classList.remove('active')\r\n    }\r\n  }\r\n  // 获取二维数组中子数组的最大长度\r\n  getArrMaxLength(arr) {\r\n    // 初始化最大长度为 0\r\n    var maxLength = 0;\r\n\r\n    // 遍历二维数组，比较每个子数组的长度\r\n    for (var i = 0; i < arr.length; i++) {\r\n      if (arr[i].length > maxLength) {\r\n        maxLength = arr[i].length;\r\n      }\r\n    }\r\n    // 返回最大长度\r\n    return maxLength;\r\n  }\r\n  /**\r\n   * 获取频率范围\r\n   * @param {*} datas \r\n   * @returns \r\n   */\r\n  getFreqRange(datas) {\r\n    var min = Infinity,\r\n      max = -Infinity;\r\n    for (var i = 0; i < datas.length; i++) {\r\n      var item = datas[i];\r\n      if (!item) continue;\r\n      min = Math.min(min, item.start_freq, item.end_freq);\r\n      max = Math.max(max, item.start_freq, item.end_freq);\r\n    }\r\n    return {\r\n      min: min,\r\n      max: max\r\n    }\r\n  }\r\n  /**\r\n   * 布局算法\r\n   * @param {*} events \r\n   * @returns \r\n   */\r\n\r\n  layoutEvents(events) {\r\n    var tracks = [];\r\n    var SAFE_MARGIN = 1; // 安全边距\r\n\r\n    // 使用 slice() 替代扩展运算符实现数组拷贝\r\n    var sorted = events.slice().sort(function (a, b) {\r\n      return a.start_freq - b.start_freq ||\r\n        (b.end_freq - b.start_freq) - (a.end_freq - a.start_freq) ||\r\n        a.end_freq - b.end_freq;\r\n    });\r\n    sorted.forEach(function (event) {\r\n      var merged = false;\r\n\r\n      // 替换 for...of 为常规 for 循环\r\n      for (var t = 0; t < tracks.length; t++) {\r\n        var track = tracks[t];\r\n        if (canMergeVerticallys(track, event)) {\r\n          track.push(event);\r\n          merged = true;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (!merged) {\r\n        // 水平轨道优化\r\n        var bestTrack = -1;\r\n        var bestEnd = Infinity;\r\n\r\n        // 循环变量改用 var 声明\r\n        for (var i = 0; i < tracks.length; i++) {\r\n          var last = tracks[i][tracks[i].length - 1];\r\n          if (event.start_freq >= last.end_freq - SAFE_MARGIN) {\r\n            if (last.end_freq < bestEnd) {\r\n              bestTrack = i;\r\n              bestEnd = last.end_freq;\r\n            }\r\n          }\r\n        }\r\n\r\n        if (bestTrack !== -1) {\r\n          // 自动时间补偿\r\n          var prevEvent = tracks[bestTrack][tracks[bestTrack].length - 1];\r\n          if (prevEvent.end_freq > event.start_freq) {\r\n            prevEvent.end_freq = event.start_freq - SAFE_MARGIN;\r\n          }\r\n          tracks[bestTrack].push(event);\r\n        } else {\r\n          tracks.push([event]);\r\n        }\r\n      }\r\n    });\r\n    // 确保即使只有一条数据也返回二维数组\r\n    if (tracks.length === 1 && tracks[0].length === 1) {\r\n      tracks = [tracks[0]]; // 将单个数组包装在一个新的数组中\r\n    }\r\n    //console.log(\"算法\", tracks)\r\n    return tracks;\r\n  }\r\n  /**\r\n   * 计算排序\r\n   * @param {*} events \r\n   */\r\n  computSort(events) {\r\n    var sorted = events.slice().sort(function (a, b) {\r\n      return a.start_freq - b.start_freq ||\r\n        (b.end_freq - b.start_freq) - (a.end_freq - a.start_freq) ||\r\n        a.end_freq - b.end_freq;\r\n    });\r\n    //console.log(\"排序后的事件\", sorted)\r\n    return sorted\r\n  }\r\n  // 防抖包装器（私有方法）\r\n  // debounce(fn, delay) {\r\n  //   let timer = null;\r\n  //   return (...args) => {\r\n  //     clearTimeout(timer);\r\n  //     this.showconsole(\"防抖函数\")\r\n  //     console.log(\"防抖函数\", args)\r\n  //     timer = setTimeout(() => fn(...args), delay);\r\n  //   };\r\n  // }\r\n  // 防抖包装器（私有方法）\r\n  // debounce(fn, delay) {\r\n  //   let timer = null;\r\n  //   return (...args) => {\r\n  //     clearTimeout(timer);\r\n  //     this.showconsole(\"防抖函数\")\r\n  //     console.log(\"防抖函数\", args)\r\n  //     timer = setTimeout(() => fn(...args), delay);\r\n  //   };\r\n  // }\r\n  // 防抖：确保函数在最后一次触发后一定时间才执行\r\n  debounce(func, delay) {\r\n    let timeout;\r\n    return function (...args) {\r\n      clearTimeout(timeout);\r\n      timeout = setTimeout(() => func.apply(this, args), delay);\r\n    };\r\n  }\r\n\r\n  // 节流：确保函数在指定时间间隔内只执行一次\r\n  throttle(func, delay) {\r\n    let lastTime = 0;\r\n    return function (...args) {\r\n      const now = new Date().getTime();\r\n      if (now - lastTime >= delay) {\r\n        func.apply(this, args);\r\n        lastTime = now;\r\n      }\r\n    };\r\n  }\r\n  // 销毁实例方法\r\n  destroy() {\r\n    this.canvas.removeEventListener('mousedown', this.mousedown.bind(this));\r\n    this.canvas.removeEventListener('mouseup', this.mouseup.bind(this))\r\n    this.canvas.removeEventListener('mousemove', this.mousemove.bind(this));\r\n    this.canvas.removeEventListener('mouseout', this.mouseout.bind(this))\r\n    this.canvas.removeEventListener('touchstart', this.touchstart.bind(this));\r\n    this.canvas.removeEventListener('touchmove', this.touchmove.bind(this));\r\n    this.canvas.removeEventListener('touchend', this.touchend.bind(this));\r\n\r\n    this.canvas.removeEventListener('wheel', this.handleWheel.bind(this));\r\n    this.canvas.removeEventListener('dblclick', this.handleDblClick.bind(this));\r\n    this.canvas.removeEventListener('click', this.handleClick.bind(this));\r\n    this.canvas.removeEventListener('contextmenu', this.handleContextMenu.bind(this));\r\n    window.removeEventListener('keydown', this.handleKeydown.bind(this));\r\n    window.removeEventListener('keyup', this.handleKeyup.bind(this));\r\n    // 监听窗口调整大小\r\n    window.removeEventListener('resize', () => this.resizeCanvas());\r\n    this.treeData = null;\r\n    this.inittreeData = null;\r\n  }\r\n  showconsole(data) {\r\n    if(!this.options.isPrint){\r\n      return false;\r\n    }\r\n    // var nowdragtimes = new Date().getTime()\r\n    var nowdragtimes = \"\"\r\n    if (typeof data === 'object' && data !== null) {\r\n      data = JSON.stringify(data)\r\n    }\r\n    var reqdata = data.replace(/\\s+/g, '')\r\n    var texts = '<p><span>' + nowdragtimes + '</span>' + reqdata + '</p>'\r\n    // $(\"#consolelogs\").append(texts)\r\n    document.getElementById(\"consolelogs\").innerHTML += texts\r\n  }\r\n}\r\n\r\n\r\nexport default freqChart"],"names":["deepMerge","target","source","key","hasOwnProperty","_typeof","Array","isArray","truncateNumber","num","decimalPlaces","isnum","isNaN","Math","max","floor","factor","pow","truncated","trunc","parseFloat","toFixed","colorTostring","array","concat","canMergeVerticallys","track","events","every","e","end_freq","start_freq","freqChart","id","options","treedata","_this","this","_classCallCheck","_isMyClassInstance","devicePixelRatio","box","document","getElementById","canvasEls","querySelectorAll","ids","length","remove","canvas","createElement","style","position","appendChild","ctx","getContext","imageSmoothingEnabled","bottomBox","display","lockBox","loadMask","scrollBar","scrollBarContent","gridbackground","treeData","onFreqChangeCallback","callbackFreq","min","onClickGridCallback","onKeyCallback","onClickZommCallback","onFocusCallback","onSwitchCallback","zoomStatus","chartWidth","chartHeight","xLabelGridInfo","inittreeData","wifiMaxrows","freqPxStep","freqXDiff","initDefault","initOptions","readJsonData","addEventListener","mousedown","bind","mouseup","throttle","mousemove","mouseout","touchstart","touchmove","touchend","handleWheel","handleDblClick","handleClick","event","showconsole","preventDefault","setZomm","setSwitch","handleContextMenu","window","handleKeydown","handleKeyup","resizeCanvas","handleScroll","mousedownScroll","mousemoveScroll","mouseupScroll","eleactives","i","classList","buttonfocus","button","show_zoom_button","push","type","column","row","show_switch_button","leng","focusInfo","isLock","focus","prefocus","list","mousedownInfo","isMouseDown","startX","startY","mouseupx","mouseupy","moveInfo","isMove","preX","preY","moveX","moveY","scrollBarInfo","drawChart","value","isDraw","isDragging","isZooming","offsetX","offsetY","scaleX","scaleY","scaleDirection","selectedArea","touchStartDist","touchStartInfo","touch_center_freq","prevTouchDistance","isTouching","touchStartX","touchStartY","isTouchDragging","lastTouchDistance","lastTouchCenterX","focusType","widths","heights","width","height","containerWidth","clientWidth","containerHeight","clientHeight","grid","left","right","top","bottom","types","mergedOptions","isPrint","background","language_code","isreadfile","channel_show","scrollbar_show","track_gap","track_title_height","track_min_height","channel_max_height","track_grid_min_width","stroke_color","stroke_width","stroke_focus_width","stroke_focus_color","x_axis","decimals","unit","unit_right","unit_position","show_top_label","show_bottom_label","init_start_freq","init_end_freq","text_color","text_font_size","text_font_family","color","item_min_width","labels","background_button","lock","content","font_size","label_angle","tree_data","buttons","getElementsByClassName","flex","backgroundColor","zoomBox","switchBox","setCanvasSize","datas","format_type","bg_color","band_list","JSON","parse","stringify","performance","now","initgrid","griddatas","getRegionData","calculateItemData","initgridFreq","getMaxRowNum","initlaydata","layoutEvents","layoutArr","initCulateItemData","initFocusList","limit_start_freq","limit_end_freq","regionData","data","maxRowNum","child_band","_this2","splice","columnRow","focusArr","rows","business","j","focusitem","direction","orderid","maxLength","l","transposedArray","d","newRow","k","undefined","forEach","item","index","chartWidths","freqdiff","freqStep","gridData","start_x","end_x","label_start_freq","column_id","label_start_x","label_end_x","label_end_freq","rowHeight","item_id","parent_foot_notes","foot_notes","x","y","getItemColor","business_id","text","getItemText","typestr","_this3","trackGap","trackHeight","rowsNum","rowTitleHeight","rowarr","child_band_ranges","texts","rowdata","_loop","sub_title","sub_title_height","childtype","parent_orderid","language","code","name","business_name","childTreeData","child_band_range","child_business_list","setLoadMask","start","clearCanvas","initBackground","initData","drawAxis","drawGrid","updateScrollbar","debounce","drawCharts","clearRect","fillStyle","fillRect","_this4","initdrawData","selcetedFocus","strokeStyle","lineWidth","beginPath","moveTo","lineTo","stroke","textBaseline","font","measureText","fillText","pointy","pointx","columnData","drawItemText","labelx_axis","offsetx","save","rect","clip","strokeWidth","isHaveselectedArea","itemArray","setLineDash","strokeRect","drawTree","drawTexts","restore","treeDatas","rowwidth","listdata","business_list","languagelist","translate","textAlign","fontSize","lineHeight","maxLines","lines","splitText","line","maxHeight","maxWidth","currentLine","testLine","slice","_this5","totalHeight","paragraph","words","split","nextWord","shift","touches","clientX","clientY","touch1","touch2","getTouchMouseVal","getDistance","abs","changeMovex","offsety","changeMovey","touchDist","getAngle","dx","pageX","dy","pageY","scaleChange","mouseVal","newfreqStep","minValue","maxValue","ceil","sqrt","atan2","PI","cursor","mousedowinfo","_objectSpread","moveDirX","moveDirY","movex","diffPx","movey","newoffsety","delta","deltaY","handleZoom","changedTouches","getBoundingClientRect","mouseX","mouseY","clickedArea","checkClick","area","focusList","getFocusList","changeFocus","childArea","returnData","areas","areaX","areaY","areaWidth","areaHeight","keyCode","threshold","is_mouse","scrollTop","setOffsetY","isshow","offsetHeight","stopPropagation","order","getMousePosition","zoomFactor","getMouseVal","centerX","result","rangeData","end","names","uniqueChinese","arr","hashMap","Object","create","callback","newoptions","innerText","action","currentRows","click","gridInfo","getGridInfo","backgroundImage","columns","items","clearElmentFocus","add","Infinity","tracks","sort","a","b","merged","t","bestTrack","bestEnd","last","prevEvent","func","delay","timeout","_this6","_len","arguments","args","_key","clearTimeout","setTimeout","apply","lastTime","Date","getTime","_len2","_key2","_this7","removeEventListener","replace","innerHTML"],"mappings":"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"}